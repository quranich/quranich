-- <|> Hello, fucker | Taxin2012 and PURP was here | Mysterious Zone Project | mzrp.ru <|>
local a=ix.plugin.list["inventory-module-vendor-dlc-dialogs"]function ix.dlc_vendor.dialogs.ReadApi(b,c)local d,e=LocalPlayer(),(b=="map"and"map/"..game.GetMap(true)or b)if(d.nextAPIAction or 0)<CurTime()then d.nextAPIAction=CurTime()+.5 kouka.ApiRequest("/dialogs/"..e,"GET",nil,function(f,g,h)c((f==200 and g)and util.JSONToTable(g)or{})end,nil,true)end end net.Receive("dialogSystem_OpenAdminMenuFrame",function()local b=LocalPlayer()if not CAMI.PlayerHasAccess(b,"Helix - Manage Dialogs",nil)then b:Notify("У вас недостаточно прав.")return end ix.gui.adminMenuDialogs=vgui.Create("dialogs.admin-menu")ix.gui.adminMenuDialogs:InitLoading("Загрузка данных")ix.dlc_vendor.dialogs.ReadApi("maps/",function(c)if IsValid(ix.gui.adminMenuDialogs)then ix.gui.adminMenuDialogs:InitData(c)end end)end)net.Receive("dialogSystem_OpenVendorEditFrame",function()local b=LocalPlayer()local c=net.ReadEntity()if(!IsValid(c)or!CAMI.PlayerHasAccess(LocalPlayer(),"Helix - Manage Dialogs",nil))then return end c.money=net.ReadUInt(16)c.items=net.ReadTable()c.scale=net.ReadFloat()c.messages=net.ReadTable()c.factions=net.ReadTable()c.classes=net.ReadTable()ix.gui.vendor=vgui.Create("ixVendor")ix.gui.vendor:SetReadOnly(true)ix.gui.vendor:Setup(c)ix.gui.vendorEditor=vgui.Create("dialogs.admin-menu.vendor")ix.gui.vendorEditor:InitFrame(c)end)net.Receive("dialogSystem_RefreshUI",function()local b=LocalPlayer()if not CAMI.PlayerHasAccess(b,"Helix - Manage Dialogs",nil)then b:Notify("У вас недостаточно прав.")return end local c=net.ReadUInt(2)if c==1 then ix.dlc_vendor.dialogs.ReadApi("maps/",function(d)if IsValid(ix.gui.adminMenuDialogs)then ix.gui.adminMenuDialogs:InitData(d)end end)end end)net.Receive("dialogSystem_OpenFrame",function()local b=net.ReadEntity()if(!IsValid(b))then return end b.money=net.ReadUInt(16)b.items=net.ReadTable()b.scale=net.ReadFloat()b.dialog=net.ReadString()ix.gui.dialog=vgui.Create("dialog.user-frame")ix.gui.dialog:Setup(b)end)hook.Add("VendorDLC.EditorFrame","VendorDLC.EditorFrame.Dialogs-for-NPC",function(b)b["dialogs"]={name="Диалоги",draw_editor=function(c,self,d)if not IsValid(d)then return end local e=d:GetNWString("dialogIndex","")local f=d:GetNWBool("disableVoice",false)local g=vgui.Create("DCheckBoxLabel",self)g:Dock(TOP)g:DockMargin(5,5,0,10)g:SetFont("ui.Tahoma-8")g:SetText("Отключить разговор")g:SetValue(f)g:SizeToContents()g.OnChange=function(k,l)c:updateVendor("disableVoice",l)end local h=vgui.Create("DLabel",self)h:Dock(TOP)h:DockMargin(0,0,0,0)h:SetTextColor(color_white)h:SetFont("ui.Tahoma-8")h:SetText("Введите номер диалога")h:SizeToContents()local i=vgui.Create("DTextEntry",self)i:Dock(TOP)i:SetValue(e)i.OnEnter=function(k,l)c:updateVendor("dialogIndex",l)end local j=vgui.Create("ixMenuButton",self)j:SetFont("ui.Tahoma-7")j:SetText("Открыть меню диалогов")j:Dock(TOP)j:DockMargin(5,5,5,5)j:SetTextColor(color_white)j:DockMargin(0,0,0,0)j:SizeToContents()j.DoClick=function(k)ix.command.Send("DialogsAdminMenu")end end,}end)