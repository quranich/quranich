-- <|> Hello, fucker | Taxin2012 and PURP was here | Mysterious Zone Project | mzrp.ru <|>
local a=ix.plugin.list["inventory-module-aitems-list"]local b=table.Merge(ix.protectStatsIcons,ix.weaponStatsIcons)local c=ix.util.GetMaterial('purp/stalker/ui//ui_actor_sleep_screen.png')local d=Color(110,114,113)local e,f=Color(184,186,183),Color(197,75,75)local g=ix.weaponStatsIconsARC9 local function h(i,j,k,l,m,n,o,p)p=p or 3 local q=weapons.Get(i.weaponClass)if not q then return end local r=q.Attachments for s,t in next,m do if t.Installed==nil and(t.SubAttachments and istable(t.SubAttachments)and table.IsEmpty(t.SubAttachments)==true)then continue end if o[t.Installed]and(not t.SubAttachments or t.SubAttachments and table.IsEmpty(t.SubAttachments)==true)then continue end local u=n:Add("EditablePanel")u:Dock(TOP)u:DockMargin(k*p,0,k*10,l*0)u:SetTall(l*32)u:InvalidateParent(true)local v=u:Add("DLabel")v:Dock(LEFT)v:DockMargin(k*p,0,0,0)v:SetFont("ui.Tahoma-6")v:SetTextColor(Color(150,150,150))v:SetText("["..s.."]")v:SizeToContents()if t.Installed==nil and r[s]and r[s].PrintName then v:SetText("["..s.."] - "..r[s].PrintName)v:SizeToContents()end for w,x in next,t do if w=="Installed"then local y=ix.item.list[x]if not y then continue end local z=u:Add("DLabel")z:Dock(LEFT)z:DockMargin(k*5,0,0,0)z:SetFont("ui.Tahoma-6")z:SetTextColor(Color(150,150,150))z:SetText(y.name)z:SizeToContents()elseif w=="SubAttachments"then if x and table.IsEmpty(x)==false then h(i,j,k,l,x,n,o,p+10)end end end n:InvalidateLayout(true)n:SizeToChildren(false,true)end j:SizeToContents()end function a:TooltipSpacer(i,j,k)local l=j:AddRow(k)l:SetText("")l:DockMargin(10,0,10,0)l:SetTextColor(color_white)l:SizeToContents()l.Paint=function(m,n,o)for p=0,n do if p%10==0 then draw.RoundedBox(0,p,o*0.5,5,1,Color(70,75,78))end end end return l end function a:TooltipAttachmentsStats(i,j)local k,l=ScrW()/1920,ScrH()/1080 local m=Color(38,198,192)local n=Color(111,111,111)local o=Color(171,177,180)local p=math.max(19,19*l)local q=ix.item.list if not ARC9 then return end local r=ARC9.GetAttTable(i.uniqueID)local s=j:AddRow("rowAttStats")s:SetText("")s:SetTall(0)local t=table.Copy(ix.weaponStatsIconsARC9)t["AimDownSightsTime"]={order=8,name="Скорость прицеливания",negation=true,max=2,iconX=711,iconY=699,}t["ReloadTime"]={order=9,name="Скорость перезарядки",negation=true,max=2,iconX=730,iconY=604,}for u,v in next,r do for w,x in next,t do if string.match(u,w)then local y=x.name local z=x.negation local A=x.max local B=x.iconX local C=x.iconY local D=v<1 if z==true then D=not D end local E=s:Add("EditablePanel")E:Dock(TOP)E:DockMargin(k*5,0,k*10,l*5)E:SetTall(p)E:InvalidateParent(true)local F=E:Add("EditablePanel")F:Dock(LEFT)F:SetWide(p)F.Paint=function(J,K,L)surface.SetDrawColor(D and Color(206,73,74)or m)surface.SetMaterial(c)surface.DrawPartialTexturedRect(0,0,K,L,B,C,19,19,1024,1024)end local G=E:Add("DLabel")G:Dock(LEFT)G:DockMargin(k*5,0,0,0)G:SetFont("ui.Tahoma-s7")G:SetTextColor(n)G:SetText(y)G:SizeToContents()local H=math.abs((0+(1*(v-1)))*100)if w=="Recoil"then H=D and"+"..H.."%"or"-"..H.."%"else H=D and"-"..H.."%"or"+"..H.."%"end local I=E:Add("DLabel")I:Dock(RIGHT)I:DockMargin(k*5,0,0,0)I:SetFont("ui.Tahoma-s7")I:SetTextColor(o)I:SetText(H)I:SizeToContents()end end end s:InvalidateLayout(true)s:SizeToChildren(false,true)end function a:TooltipWeaponStats(i,j)local k,l=ScrW()/1920,ScrH()/1080 local m=Color(38,198,192)local n=Color(111,111,111)local o=Color(171,177,180)local p=math.max(19,19*l)local q=weapons.Get(i.weaponClass)local r=ix.item.list local s={}local t=i:GetData("upgrades",{})local u=i:GetData("attachments",{})if not q then return end local v=j:AddRow("rowWeaponStats")v:SetText("")v:SetTall(0)for x,y in SortedPairsByMemberValue(g,"order")do if y.itemHide==true then continue end local z=y.name local A=y.negation local B=y.max local C=y.iconX local D=y.iconY local E=v:Add("EditablePanel")E:Dock(TOP)E:DockMargin(k*5,0,k*10,l*5)E:SetTall(p)E:InvalidateParent(true)E.Paint=function(K,L,M)end local F=E:Add("EditablePanel")F:Dock(LEFT)F:SetWide(p)F.Paint=function(K,L,M)surface.SetDrawColor(m)surface.SetMaterial(c)surface.DrawPartialTexturedRect(0,0,L,M,C,D,19,19,1024,1024)end local G=E:Add("DLabel")G:Dock(LEFT)G:DockMargin(k*5,0,0,0)G:SetFont("ui.Tahoma-s7")G:SetTextColor(n)G:SetText(z)G:SizeToContents()local H=0 local I=0 if y.GetStat then H=y.GetStat(q,u,i)I=math.min(H/y.max,100)end local J=E:Add("EditablePanel")J:Dock(RIGHT)J:SetWide(k*200)J:DockMargin(0,0,0,0)J.Paint=function(K,L,M)local N=M*0.5-5 for O=0,L do if O%4==0 then draw.RoundedBox(0,O,N,2,10,Color(70,75,78))end end if I then local O=math.abs(I)for P=0,O*L do if P%4==0 then draw.RoundedBox(0,P,N,2,10,o)end end end end end v:InvalidateLayout(true)v:SizeToChildren(false,true)local w=q.Ammo if w then local x=r[w]if x then local y=j:AddRow("weaponAmmo")y:SetText("")y:SetTall(0)local z=y:Add("EditablePanel")z:Dock(TOP)z:DockMargin(k*5,l*10,k*10,l*10)z:SetTall((50*x.height)*l)z:InvalidateParent(true)z.Paint=function(B,C,D)ix.stalkerInventory.DrawItemIcon(x,(50*x.width)*l,D,B,true)end local A=z:Add("DLabel")A:Dock(RIGHT)A:DockMargin(k*10,0,0,0)A:SetFont("ui.Tahoma-6")A:SetText(x.name)A:SetTextColor(o)A:SizeToContents()y:InvalidateLayout(true)y:SizeToChildren(false,true)end end if t and table.IsEmpty(t)==false then a:TooltipSpacer(i,j,"weaponUpgradesSpacer")local x=j:AddRow("weaponUpgradesRow")x:SetText("")x:SetTall(0)local y={}for z,A in next,t do for B,C in next,A do local D=ix.upgradeRepair:GetUpgradeTable(z,C)if D then local E=ix.upgradeRepair:GetUpgradeAttachments(z,C)local F=D.weaponStats if F then y[z]=y[z]or{}if y[z]["stats"]==nil then y[z]["stats"]={}end if not y[z]["stats"].level or y[z]["stats"].level and y[z]["stats"].level<B then y[z]["stats"]={name=D.name,level=B,}end end if E and table.IsEmpty(E)==false then for G,H in next,E do s[H]=true end y[z]=y[z]or{}if y[z]["atts"]==nil then y[z]["atts"]={}end if not y[z]["atts"].level or y[z]["atts"].level and y[z]["atts"].level<B then y[z]["atts"]={name=D.name,level=B,}end end end end end for z,A in next,y do for B,C in next,A do local D=B=="stats"local E=D and 673 or 692 local F=D and 623 or 661 local G=D and Color(184,186,183)or Color(184,220,183)local H=x:Add("EditablePanel")H:Dock(TOP)H:DockMargin(k*7,0,0,l*5)H:SetTall(p)H.Paint=function(J,K,L)surface.SetDrawColor(G)surface.SetMaterial(c)surface.DrawPartialTexturedRect(0,0,L,L,E,F,19,19,1024,1024)end local I=H:Add("DLabel")I:Dock(LEFT)I:DockMargin(p+k*10,0,0,0)I:SetFont("ui.Tahoma-s7")I:SetTextColor(Color(184,186,183))I:SetText("[ур."..C.level.."] "..C.name)I:SizeToContents()end end x:InvalidateLayout(true)x:SizeToChildren(false,true)end if u and table.IsEmpty(u)==false then a:TooltipSpacer(i,j,"weaponAttachmentsSpacer")local x=j:AddRow("weaponAttachmentsRow")x:SetText("")x:SetTall(0)local y=x:Add("DLabel")y:Dock(TOP)y:DockMargin(k*5,0,0,l*5)y:SetFont("ui.Tahoma-7")y:SetTextColor(Color(184,186,183))y:SetText("Навесное оборудование: ")y:SizeToContents()h(i,j,k,l,u,x,s)x:InvalidateLayout(true)x:SizeToChildren(false,true)end j.changedSize=k*520 j:SizeToContents()end function a:TooltipProperty(i,j)local k,l=ScrW()/1920,ScrH()/1080 local m=Color(38,198,192)local n=Color(111,111,111)local o=Color(171,177,180)local p=math.max(19,19*l)local q=ix.item.list local r=i:AddRow("propertyStats")r:SetText("")r:SetTall(0)local s={}for t,u in next,j do for v,w in next,ix.weaponStatsIconsARC9 do if string.match(t,v)then local x=w.name local y=w.negation local z=w.max local A=w.iconX local B=w.iconY local C=u<1 if y==true then C=not C end local D=r:Add("EditablePanel")D:Dock(TOP)D:DockMargin(k*5,0,k*10,l*5)D:SetTall(p)D:InvalidateParent(true)local E=D:Add("EditablePanel")E:Dock(LEFT)E:SetWide(p)E.Paint=function(I,J,K)surface.SetDrawColor(C and Color(206,73,74)or m)surface.SetMaterial(c)surface.DrawPartialTexturedRect(0,0,J,K,A,B,19,19,1024,1024)end s[t]=true local F=D:Add("DLabel")F:Dock(LEFT)F:DockMargin(k*5,0,0,0)F:SetFont("ui.Tahoma-s7")F:SetTextColor(n)F:SetText(x)F:SizeToContents()local G=math.abs((0+(1*(u-1)))*100)if v=="Recoil"then G=C and"+"..G.."%"or"-"..G.."%"else G=C and"-"..G.."%"or"+"..G.."%"end local H=D:Add("DLabel")H:Dock(RIGHT)H:DockMargin(k*5,0,0,0)H:SetFont("ui.Tahoma-s7")H:SetTextColor(o)H:SetText(G)H:SizeToContents()r:SizeToContents()end end end r:InvalidateLayout(true)r:SizeToChildren(false,true)i:SizeToContents()for t,u in next,j do if s[t]then continue end local v=isstring(t)and t:upper()or t local w=b[v]or{v,654,718}local x=w[1]local y,z=w[2],w[3]local A=color_white local B=color_white local C=(u>=0 and"+"..u or u)if ix.weaponStatsIcons[v]then colorRender=u<=0 and Color(33,138,197)or Color(206,73,74)B=u<=0 and e or f else colorRender=u>=0 and Color(33,138,197)or Color(206,73,74)B=u>=0 and e or f end local D=r:Add("EditablePanel")D:Dock(TOP)D:DockMargin(k*5,0,k*10,l*5)D:SetTall(k*19)D:InvalidateParent(true)local E=r:GetTall()+D:GetTall()r:SetTall(E+l*5)local F=D:Add("EditablePanel")F:Dock(LEFT)F:SetWide(D:GetTall())F.Paint=function(J,K,L)surface.SetDrawColor(colorRender)surface.SetMaterial(c)surface.DrawPartialTexturedRect(0,0,K,L,y,z,19,19,1024,1024)end local G=D:Add("DLabel")G:Dock(LEFT)G:DockMargin(5,0,0,0)G:SetFont("ui.Tahoma-6")G:SetTextColor(d)G:SetText(x)G:SizeToContents()local H=(u>=0 and"+"..u or u)local I=D:Add("DLabel")I:Dock(RIGHT)I:DockMargin(0,0,0,0)I:SetFont("ui.Tahoma-6")I:SetText(H)I:SetTextColor(B)I:SizeToContents()end i:SizeToContents()end function a:TooltipProtectStats(i,j)local k=i.protectStats if k then j:SizeToContents()local l=j:AddRow("protection_panel")l:SetText("")l:SetTall(0)if i.weightModify and i.weightModify~=0 then local n=l:Add("DPanel")n:Dock(TOP)n:DockMargin(0,0,0,5)n:SetTall(19)n:SetPaintBackground(false)local o=n:Add("DPanel")o:Dock(LEFT)o:SetWide(19)o.Paint=function(r,s,t)surface.SetDrawColor(color_white)surface.SetMaterial(c)surface.DrawPartialTexturedRect(0,0,19,19,768,471,19,19,1024,1024)end local p=n:Add("DLabel")p:Dock(LEFT)p:DockMargin(5,0,0,0)p:SetFont("ui.Tahoma-6")p:SetTextColor(Color(110,114,113))p:SetText("Максимальный вес")p:SizeToContents()local q=n:Add("DLabel")q:Dock(RIGHT)q:DockMargin(0,0,0,0)q:SetFont("ui.Tahoma-6")q:SetTextColor(Color(184,186,183))q:SetText("+"..i.weightModify.." кг")q:SetContentAlignment(5)q:SizeToContents()end for n,o in pairs(k)do if not b[n]or isstring(n)then continue end if o==0 then continue end local p=l:Add("DPanel")p:Dock(TOP)p:DockMargin(0,0,0,3)p:SetTall(19)p:SetPaintBackground(false)local q=p:Add("DPanel")q:Dock(LEFT)q:SetWide(19)q.Paint=function(t,u,v)surface.SetDrawColor(o>=0 and Color(33,138,197)or Color(206,73,74))surface.SetMaterial(c)surface.DrawPartialTexturedRect(0,0,19,19,b[n][2],b[n][3],19,19,1024,1024)end local r=p:Add("DLabel")r:Dock(LEFT)r:DockMargin(5,0,0,0)r:SetFont("ui.Tahoma-6")r:SetTextColor(Color(110,114,113))r:SetText(b[n][1])r:SizeToContents()o=o*.01 local s=p:Add("DPanel")s:Dock(RIGHT)s:DockMargin(0,0,0,0)s:SetWide((j:GetWide()-200)*0.75)s.Paint=function(t,u,v)for w=0,u do if w%4==0 then draw.RoundedBox(0,w,v*0.5-(10*0.5),2,10,Color(70,75,78))end end if o~=0 then local w=math.abs(o)for x=0,w*u do if x%4==0 then draw.RoundedBox(0,x,v*0.5-(10*0.5),2,10,Color(200,50,50))end end end if ix.durability then local w=o*(i:GetDurability()/ix.durability.durabilityMax)if w~=0 then for x=0,w*u do if x%4==0 then draw.RoundedBox(0,x,v*0.5-(10*0.5),2,10,Color(170,175,178))end end end end end end local m=i:HasUpgrades()if m then local n=l:Add("DPanel")n:Dock(TOP)n:DockMargin(0,0,0,3)n:SetTall(19)n:SetPaintBackground(false)n.Paint=function(t,u,v)for w=0,u do if w%10==0 then draw.RoundedBox(0,w,v*0.5,5,1,Color(70,75,78))end end end local o=l:Add("DLabel")o:Dock(TOP)o:DockMargin(5,0,0,10)o:SetFont("ui.Tahoma-7")o:SetTextColor(Color(184,186,183))o:SetText("Модификации")o:SizeToContents()local p=i:GetUpgrades()local q,r=0,0 for t,u in next,p do for v,w in next,u do local x=ix.upgradeRepair:GetUpgradeProtectStat(t,w)if x then q=q+(x["WEIGHT"]or 0)r=r+(x["ARTCONT"]or 0)end end end if q~=0 then local t=l:Add("DPanel")t:Dock(TOP)t:DockMargin(0,0,0,5)t:SetTall(19)t:SetPaintBackground(false)local u=t:Add("DPanel")u:Dock(LEFT)u:SetWide(19)u.Paint=function(x,y,z)surface.SetDrawColor(color_white)surface.SetMaterial(c)surface.DrawPartialTexturedRect(0,0,19,19,768,471,19,19,1024,1024)end local v=t:Add("DLabel")v:Dock(LEFT)v:DockMargin(5,0,0,0)v:SetFont("ui.Tahoma-6")v:SetTextColor(Color(110,114,113))v:SetText("Максимальный вес")v:SizeToContents()local w=t:Add("DLabel")w:Dock(RIGHT)w:DockMargin(0,0,0,0)w:SetFont("ui.Tahoma-6")w:SetTextColor(Color(184,186,183))w:SetText((q>=0 and"+"or"")..q.." кг")w:SetContentAlignment(5)w:SizeToContents()end if r~=0 then local t=l:Add("DPanel")t:Dock(TOP)t:DockMargin(0,0,0,5)t:SetTall(19)t:SetPaintBackground(false)local u=t:Add("DPanel")u:Dock(LEFT)u:SetWide(19)u.Paint=function(x,y,z)surface.SetDrawColor(color_white)surface.SetMaterial(c)surface.DrawPartialTexturedRect(0,0,19,19,768,471,19,19,1024,1024)end local v=t:Add("DLabel")v:Dock(LEFT)v:DockMargin(5,0,0,0)v:SetFont("ui.Tahoma-6")v:SetTextColor(Color(110,114,113))v:SetText("Артефакт")v:SizeToContents()local w=t:Add("DLabel")w:Dock(RIGHT)w:DockMargin(0,0,0,0)w:SetFont("ui.Tahoma-6")w:SetTextColor(Color(184,186,183))w:SetText((r>=0 and"+"or"")..r.." шт.")w:SetContentAlignment(5)w:SizeToContents()end for t,u in pairs(k)do if not b[t]or isstring(t)then continue end if u==0 then continue end local v=i:GetUpgradesProtectStats()if v[t]then u=v[t]if u==0 then continue end local w=l:Add("DPanel")w:Dock(TOP)w:DockMargin(0,0,0,3)w:SetTall(19)w:SetPaintBackground(false)local x=w:Add("DPanel")x:Dock(LEFT)x:SetWide(19)x.Paint=function(A,B,C)surface.SetDrawColor(u>=0 and Color(33,138,197)or Color(206,73,74))surface.SetMaterial(c)surface.DrawPartialTexturedRect(0,0,19,19,b[t][2],b[t][3],19,19,1024,1024)end local y=w:Add("DLabel")y:Dock(LEFT)y:DockMargin(5,0,0,0)y:SetFont("ui.Tahoma-6")y:SetTextColor(Color(110,114,113))y:SetText(b[t][1])y:SizeToContents()local z=w:Add("DLabel")z:Dock(RIGHT)z:SetContentAlignment(6)z:DockMargin(0,0,0,0)z:SetFont("ui.Tahoma-6")z:SetTextColor(Color(184,186,183))z:SetText((u>=0 and"+"or"")..u)z:SetWide((j:GetWide()-200)*0.75)end end local s=l:Add("DPanel")s:Dock(TOP)s:DockMargin(0,0,0,3)s:SetTall(19)s:SetPaintBackground(false)s.Paint=function(t,u,v)for w=0,u do if w%10==0 then draw.RoundedBox(0,w,v*0.5,5,1,Color(70,75,78))end end end end l:InvalidateLayout(true)l:SizeToChildren(false,true)end end function a:TooltipRenderTable(i,j,k,l,m,n)if i.actorsRenderTable and i.actorsRenderTable.model then local o=j:AddRow("armor_avatar")o:DockMargin(0,10,0,0)o:SetText("")o:SetTall(ScrH()*0.225)local p=a:GetRenderModelFromArmor(i.actorsRenderTable.model,LocalPlayer():GetModel())local q=o:Add("DModelPanel")q:Dock(FILL)q:SetModel(p)q:SetVisible(false)function q:LayoutEntity(r)return end if q.Entity then local r,s=q.Entity:GetRenderBounds()local t=0 t=math.max(t,math.abs(r.x)+math.abs(s.x))t=math.max(t,math.abs(r.y)+math.abs(s.y))t=math.max(t,math.abs(r.z)+math.abs(s.z))n=n or vector_origin q:SetFOV(l or 30)q:SetCamPos(Vector(t,t,t))q:SetLookAt((r+s)*0.5+n)local u=i:GetData("renderSkin",0)q.Entity:SetSkin(u)local v=i:GetData("renderBodygroup",{})for w,x in pairs(v)do q.Entity:SetBodygroup(w,x or 0)end end q.Think=function(r)local s=j:GetAlpha()q:SetAlpha(s*10)if IsValid(q.Entity)then local t=CurTime()local u=40*math.sin(t*(2*math.pi/5))m=m or 40 q.Entity:SetAngles(Angle(-10,m-u,-90))end end timer.Simple(.1,function()if IsValid(q)then q:SetVisible(true)end end)end end function a:TooltipPlayerModel(i,j,k)if not i.playerModel then return end local l=j:AddRow("armor_avatar")l:DockMargin(0,10,0,0)l:SetText("")l:SetTall(ScrH()*0.225)local m=l:Add("DModelPanel")m:Dock(FILL)m:SetModel(i.playerModel)m:SetVisible(false)m.LayoutEntity=function()end local n=m.Entity if not n then return end local o,p=n:GetRenderBounds()local q=math.max(math.abs(o.x)+math.abs(p.x),math.abs(o.y)+math.abs(p.y),math.abs(o.z)+math.abs(p.z))m:SetFOV(60)m:SetCamPos(Vector(q,q,q))m:SetLookAt((o+p)*0.5)local r=i:GetData("renderSkin",0)n:SetSkin(r)local s=i:GetData("renderBodygroup",{})for u,v in pairs(s)do n:SetBodygroup(u,v or 0)end local t=n:LookupSequence("idle_0_idle_0")if t~=-1 then n:ResetSequence(t)n:ResetSequenceInfo()n:SetCycle(0)n:SetPlaybackRate(1)end m.Think=function()m:SetAlpha(j:GetAlpha()*10)end timer.Simple(0.1,function()if IsValid(m)then m:SetVisible(true)end end)end