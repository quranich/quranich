-- <|> Hello, fucker | Taxin2012 and PURP was here | Mysterious Zone Project | mzrp.ru <|>
local a=ix.plugin.list["inventory-module-aitems-list"]function ix.itemsList.artcont_listregistration(d,e)d.artCount=d.artCount or 1 d.slotIndex="slotArtefact"d.isArtContainer=true d.functions.combine={OnRun=function(f,g)local h=ix.item.instances[g[1]]if h==nil then return false end if h.isModule==true then return false end local i=f.player local j=h:GetPlayerID()local k=h:GetCharacterID()local l=i:SteamID64()local m=i:GetCharacter():GetID()if(j and k and j==l and k!=m)then i:NotifyLocalized("itemOwned")return false end f:ArtefactPut(h)return false end,OnCanRun=function(f,g)local h=ix.item.instances[g[1]]if table.Count(f:GetData("artefacts",{}))>=f.artCount then return false end if h and h.slotIndex=="slotArtefact"and h.isArtContainer~=true and h.isModule~=true then return true end return false end}d.functions.takeOut={name="Вынуть Артефакт",icon="icon16/arrow_up.png",isMulti=true,order=1,multiOptions=function(f,g)local h={}local i=f:GetData("artefacts",{})for j,k in next,i do local l=ix.item.list[k.uid]if l then table.insert(h,{name=l.name,data={uid=k.uid,data=k.data},})end end return h end,OnRun=function(f,g)local h=f.player if not h then return false end local i=g and g.uid if i==nil then return false end f:ArtefactPullOut(i)return false end,OnCanRun=function(f)local g=f:GetData("artefacts",{})return IsValid(f.entity)==false and IsValid(f.player)and table.IsEmpty(g)==false end}function d:ArtefactPut(f)local g=self:GetData("artefacts",{})if table.Count(g)>=self.artCount then return false end table.insert(g,{uid=f.uniqueID,data=f.data,})self:SetData("artefacts",g)f:Remove()return true end function d:ArtefactPullOut(f)local g=self:GetData("artefacts",{})if table.Count(g)<=0 then return false end local h=ix.item.list[f]if h==nil then return false end local i=self.player if not i then return false end local j=i:GetCharacter()if not j then return false end local k=j:GetInventory()if not k then return false end for l,m in next,g do if m.uid==f then local n,o=k:Add(f,1,m.data)if n==false then i:Notify(n)return false else g[l]=nil self:SetData("artefacts",g)end break end end end end if CLIENT then hook.Add("ixPostDrawItemEntity",a.uniqueID.."ixPostDrawItemEntity.artefacts",function(d)local e=d:GetItemTable()if e and e.slotIndex=="slotArtefact"and not e.artCount then local f=d:GetPos()+d:OBBCenter()if IsValid(d.modelArtefact)==false then d.modelArtefact=ClientsideModel(e.model)d.modelArtefact:SetNoDraw(true)end local g=math.abs(math.sin(CurTime()*1.5)*5)local h=Vector(0,0,0-g)local i=Angle(0,0,0)i.y=RealTime()*20 d.modelArtefact:SetPos(f+Angle(0,0,0):Up()*g-Angle(0,0,0):Up()*3)d.modelArtefact:SetAngles(i)d.modelArtefact:DrawModel()return true end end)end local b={["gp_010"]=true,}local function c(d)local e,f=d:GetCharacter(),d:GetMoveType()if not e or f==MOVETYPE_NOCLIP then return 0 end local g=e:GetFaction()local h=ix.faction.indices[g]and ix.faction.indices[g].uniqueID or"citizen"if b[h]==true then return 0 end local i=0 local j={}j=table.Add(j,e:GetInventory():GetItems())local k,l=e:GetEquipmentInventory()if k and l then j=table.Add(j,k:GetItems())end local m=ix.item.list for n,o in next,j do if o.radiation then i=i+1*o.radiation end if o.isArtContainer then local p=o:GetData("artefacts")if p then local q=0 for r,s in next,p do local t=m[s.uid]if t and t.radiation then local u=t.radiation q=q+1*u end end if o.radResistance then q=math.max(q-o.radResistance,0)end i=i+q end end end if i~=0 then e:ModifyRadiation(i*.01)end end function ix.artefacts.PostPlayerLoadout(d)local e="ixArtefactsUpdate_"..d:SteamID64()if timer.Exists(e)then timer.Remove(e)end timer.Create(e,8,0,function()if not IsValid(d)then timer.Remove(e)return end c(d)end)end hook.Add("PostPlayerLoadout",a.uniqueID.."PostPlayerLoadout_ARTEFACTS",function(d)if SERVER then ix.artefacts.PostPlayerLoadout(d)end end)if IX_PLUGINS_LOADED and ix.itemsList and ix.itemsList.CoreItemsRegistration then ix.itemsList.CoreItemsRegistration()end if SERVER then for d,e in next,player.GetAll()do ix.artefacts.PostPlayerLoadout(e)end end