-- <|> Hello, fucker | Taxin2012 and PURP was here | Mysterious Zone Project | mzrp.ru <|>
local a=ix.plugin.list["inventory-module-aitems-list"]local b=ix.util.GetMaterial('purp/stalker/ui/ui_icon_equipment_anomaly.png')local c=Color(0,50,0,100)local d={["health"]=function(h,i,j,k)local l=j:Health()local m=j:GetMaxHealth()local n=m*(k*.01)local o=math.min(l+n,m)j:SetHealth(o)j:ScreenFade(SCREENFADE.IN,c,.5,0)end,["thirst"]=function(h,i,j,k)local l=j:GetCharacter()if not l then return end l:AddThirstPercent(k)end,["hunger"]=function(h,i,j,k)local l=j:GetCharacter()if not l then return end l:AddHungerPercent(k)end,["stamina"]=function(h,i,j,k)local l=j:GetCharacter()if not l then return end j:RestoreStamina(k)end,["gas"]=function(h,i,j,k)local l=j:GetCharacter()if not l then return end l:Modifygash(k)end,["blooding"]=function(h,i,j,k)local l=j:GetCharacter()if not l then return end local m=ix.config.Get("bloodingMaxDuration",240)local n=(m*.01)*k l:BloodingModify(-n)end,["radiation"]=function(h,i,j,k)local l=j:GetCharacter()if not l then return end k=(500*0.01)*k l:ModifyRadiation(k)end,["psy"]=function(h,i,j,k)local l=j:GetCharacter()if not l then return end k=(100*0.01)*k l:ModifyPSY(k)end,["jar"]=function(h,i,j,k)local l=j:GetCharacter()if not l then return end k=(500*0.01)*k l:ModifyPSY(k)end,["blowout_skip"]=function(h,i,j,k)local l=j:GetCharacter()if not l then return end l:SetData("blowout_skip",p_ostime()+k)j:Notify("Вы приняли '"..h.name.."' - вы невосприимчивы к выбросу в течении "..k.." сек.")end,["charfallover"]=function(h,i,j,k)local l=j:GetCharacter()if not l then return end j:SetRagdolled(true,k)end,["psy_protect"]=function(h,i,j,k)local l=j:GetCharacter()if not l then return end l:SetData("psyProtector",p_ostime()+k)j:Notify("Вы приняли '"..h.name.."' - вы невоспримчивы к пси излучению в течении "..k.." сек.")end,["rad_protect"]=function(h,i,j,k)local l=j:GetCharacter()if not l then return end l:SetData("radiationProtector",p_ostime()+k)j:Notify("Вы приняли '"..h.name.."' - вы невоспримчивы к радиации в течении "..k.." сек.")end,}local function e(h)local i=h:GetActiveWeapon()if i:GetClass()!="ix_hands"then return end if(SERVER and i:IsHoldingObject())then i:DropObject(true)return end end local function f(h,i,j,k,l)local m=isstring(i)and i or i:UniqueID()timer.Remove(h)local n="ixAct"..m timer.Remove(n)if i:IsPlayer()then net.Start("ixActionBarReset")net.Send(i)if k.soundUse then i:StopSound(k.soundUse)end if l and l~="ix_hands"then i:StripWeapon(l)end if j then i:Notify(j)end end end local function g(h,i,j)j=j or i local k=i:GetCharacter()if not k then return false end e(i)local l=(j!=i and j:IsPlayer())and j:GetCharacter()or nil local m=h.name local n=h.soundUse local o=h.invID local p=h.actionTable or{}local q=p._delay or 5 local r=h.animatedActionData local s=r and"base_weapon_action"or"ix_hands"local t=i:UniqueID()local u="ixAct"..t local v="ixOnAction"..t local w="Использование «"..m.."»"local x=h.isMedOnly if i:GetLocalVar("isCorpseProgress",false)==true then i:NotifyLocalized("Я не могу это сделать пока обрабатываю тело!")return false end local y=k:GetClass()if x and(ix.class.list[y]and ix.class.list[y].isMedic~=true)then i:Notify("Я не знаю как этим пользоваться")return false end if h.canRevive and h.canReviveSerious==nil and j:IsRagdoll()and Revive_CanRevive(i,j)==false then return false end if h.canReviveSerious and j:IsRagdoll()and Revive_CanRevive(i,j,true)==false then return false end if j~=i and j:IsRagdoll()and j.ply and(h.canRevive or h.canReviveSerious)~=true then return i:Notify("Это не поможет!")end if j!=i then s="ix_hands"if l then local B=l:GetName()if k.PrintName then B=k:PrintName(l)end w=w.." на "..B end end local z=i:GetActiveWeapon()if IsValid(z)and z.Holster then z._oldHolster=z.Holster z.Holster=function()if not IsFirstTimePredicted()then return end return true end end local A=nil if i:HasWeapon(s)==false then A=i:Give(s)else A=i:GetWeapon(s)end if IsValid(A)then if s=="base_weapon_action"then A:SetNetVar("ixItemID",h.id)A:PostSetup()end i:SelectWeapon(s)end if IsValid(z)and z._oldHolster then z.Holster=z._oldHolster z._oldHolster=nil end if timer.Exists(u)then i:NotifyLocalized("Я уже провожу действие!")return false end if n then i:EmitSound(n)end if j:IsRagdoll()and j.ply then if(h.canReviveSerious and Revive_CanRevive(i,j,true))or(h.canRevive and Revive_CanRevive(i,j))then Revive_OnStartReviving(j)end end i:SetAction(w,q,function()timer.Remove(v)if h.invID~=o then i:NotifyLocalized("Действие прервано!")return false end if j:IsRagdoll()and j.ply then if(h.canReviveSerious and Revive_CanRevive(i,j,true))or(h.canRevive and Revive_CanRevive(i,j))then Revive_Revive(i,j)Revive_OnEndReviving(j)end else for B,C in next,p do if B[1]=="_"then continue end if d[B]then d[B](h,i,j,C)else i:NotifyLocalized("not found function ("..B..")")end end end if s and s~="ix_hands"then i:StripWeapon(s)end if n then i:StopSound(n)end if h.useCount then local B=h:GetData("useCount",(h.defaultUseCount or h.useCount))B=B-1 if B<=0 then h:Remove()else h:SetData("useCount",B)end elseif x~=true then local B=h:GetData("itemStack",1)B=B-1 if B<=0 then h:Remove()else h:SetData("itemStack",B)end end if i!=j then i:ConCommand("say /me использовал «"..m.."» на человеке напротив")else i:ConCommand("say /me использовал «"..m.."»")end i:Notify("Вы успешно использовали «"..m.."»")end)timer.Create(v,.25,q/.25,function()if not IsValid(i)or not IsValid(j)then f(v,t)Revive_OnEndReviving(j)return false end if i:Alive()==false then f(v,i,nil,h)if j:IsRagdoll()and j.ply then if(h.canReviveSerious and Revive_CanRevive(i,j,true))or(h.canRevive and Revive_CanRevive(i,j))then Revive_OnEndReviving(j)end end return false end if h.movingUse!=true then local B=i:GetVelocity()local C=B:Length()if C and C~=0 then f(v,i,"Я не могу сделать это на ходу!",h,s)if j:IsRagdoll()and j.ply then if(h.canReviveSerious and Revive_CanRevive(i,j,true))or(h.canRevive and Revive_CanRevive(i,j))then Revive_OnEndReviving(j)end end return false end elseif i:IsSprinting()then f(v,i,"Я не могу сделать это на бегу!",h,s)if j:IsRagdoll()and j.ply then if(h.canReviveSerious and Revive_CanRevive(i,j,true))or(h.canRevive and Revive_CanRevive(i,j))then Revive_OnEndReviving(j)end end return false end if j~=i then local B=i:GetEyeTrace()local C=B.Entity if C~=j then f(v,i,"Необходимо сфокусироваться на цели!",h,s)if j:IsRagdoll()and j.ply then if(h.canReviveSerious and Revive_CanRevive(i,j,true))or(h.canRevive and Revive_CanRevive(i,j))then Revive_OnEndReviving(j)end end return false end end if(i:HasWeapon(s)and i:GetActiveWeapon():GetClass()~=s)or(h.invID~=o)then f(v,i,"Действие отменено!",h,s)if j:IsRagdoll()and j.ply then if(h.canReviveSerious and Revive_CanRevive(i,j,true))or(h.canRevive and Revive_CanRevive(i,j))then Revive_OnEndReviving(j)end end return false end end)end function ix.itemsList.quick_listregistration(h,i)if h.useCount then h.isStack=nil h.stackLimit=nil end h.functions.use={name="Использовать",tip="equipTip",icon="icon16/accept.png",OnRun=function(j)local k=j.player g(j,k)return false end,OnCanRun=function(j)local k=j.player return IsValid(j.entity)==false end}h.functions.useTarget={name="Использовать на ...",tip="equipTip",icon="icon16/accept.png",OnRun=function(j)local k=j.player local l=k:GetEyeTrace()local m=l.Entity if IsValid(m)and(m:IsPlayer()or m:GetNetVar("player"))then local n,o=m:GetPos(),k:GetPos()if n:DistToSqr(o)<5625 then g(j,k,m)end end return false end,OnCanRun=function(j)local k=j.player if j.targetUse!=true then return false end local l=k:GetEyeTrace()local m=l.Entity if IsValid(m)and(m:IsPlayer()or m:GetNetVar("player"))then local n,o=m:GetPos(),k:GetPos()if n:DistToSqr(o)<5625 then return true end end return false end}function h:PaintOver(j,k,l)local m=j.useCount if m then local n=j:GetData("useCount",m)n=math.min(n,6)local o,p=2600,500 local q=p-(n*50)local r=k/j.width surface.SetDrawColor(color_white)surface.SetMaterial(b)surface.DrawPartialTexturedRect(k-r,l-r,r,r,o,q,50,50,8192,4096)end end end if IX_PLUGINS_LOADED and ix.itemsList and ix.itemsList.CoreItemsRegistration then ix.itemsList.CoreItemsRegistration()end