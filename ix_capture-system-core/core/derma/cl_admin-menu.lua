-- <|> Hello, fucker | Taxin2012 and PURP was here | Mysterious Zone Project | mzrp.ru <|>
local a=ix.plugin.list["capture-system-core"]local function b(d,e)if not string.find("1234567890",e,1,true)then return true end return false end local c={}function c:Init()local d=LocalPlayer()if ix.captureSystem.HasAccess(d)==false then d:Notify("У вас недостаточно прав.")self:Remove()return end if IsValid(ix.gui.captureSystemAdminMenu)then ix.gui.captureSystemAdminMenu:Close()end local e,f=ScrW(),ScrH()local g,h=e*.55,f*.75 self:SetTitle("Система захвата территории - админ меню")self:SetSize(g,h)self:Center()self:MakePopup()self:SetSkin("Default")ix.gui.captureSystemAdminMenu=self self.panelBase=self:Add("EditablePanel")self.panelBase:Dock(FILL)self.panelBase:InvalidateParent(true)end function c:SetCaptureList(d)self._tableCaptureList=d end function c:GetCaptureList()return self._tableCaptureList or{}end function c:SetActiveCapture(d,e)self._captureUniqueName,self._captureData=d,e end function c:GetActiveCapture()return self._captureUniqueName,self._captureData end function c:InitLoading(d)self.panelBase:Clear()local e=self.panelBase:Add("EditablePanel")e:Dock(FILL)e.Paint=function(f,g,h)draw.DrawText((d or"Пожалуйста подождите..."),"ui.Tahoma-9",g*.5,h*.5,color_white,TEXT_ALIGN_CENTER)end timer.Simple(10,function()if IsValid(self)and IsValid(e)then self:Remove()return LocalPlayer():Notify("Ошибка! \nВ случае проблемы свяжитесь с PURP для исправления проблемы!")end end)end function c:SetModifySize(d,e,f)self:SetSize(ScrW()*d,ScrH()*e)self:Center()self:MakePopup()if f then self:SetTitle("Система захвата - "..f)end end function c:InitButtonPanel(d,e,f,g,h,i,j)local k=d:Add("EditablePanel")k:Dock(e)k:DockMargin(0,0,0,5)k:InvalidateParent(true)local l=k:Add("DButton")l:Dock(FILL)l:DockMargin(0,0,5,0)l:InvalidateParent(true)l:SetContentAlignment(5)l:SetFont("ui.Tahoma-7")l:SetText(f)l:SetTextStyleColor(Color(50,200,50))l:SizeToContents()l.DoClick=function()g()end local m=k:Add("DButton")m:Dock(RIGHT)m:InvalidateParent(true)m:SetContentAlignment(5)m:SetFont("ui.Tahoma-7")m:SetText(h)m:SizeToContents()m.DoClick=function()i()end if j then local n=k:Add("DButton")n:Dock(LEFT)n:InvalidateParent(true)n:SetContentAlignment(5)n:DockMargin(0,0,5,0)n:SetFont("ui.Tahoma-7")n:SetText("DEBUG")n:SizeToContents()n.DoClick=function()j()end end k:InvalidateParent(true)k:SizeToChildren(false,true)k:SetTall(k:GetTall()*1.25)end function c:InitCaptureList()local d=LocalPlayer()local e=self:GetCaptureList()self:SetActiveCapture(nil,nil)self.panelBase:Clear()self:SetModifySize(.55,.8,"Список территорий")self:InitButtonPanel(self.panelBase,TOP,"Создать зону захвата",function()self:InitCreateZonePanel()end,"Обновить",function()if ix.captureSystem.HasAccess(d,true)==true then self:InitLoading("Чтение данных ...")net.Start("captureSystemRefreshAdminMenu")net.SendToServer()end end)local f=self.panelBase:Add("DScrollPanel")f:Dock(FILL)f:InvalidateParent(true)for g,h in pairs(e)do local i=f:Add("DPanel")i:Dock(TOP)i:DockMargin(0,0,0,5)i:DockPadding(5,5,5,5)i:SetTall(draw.GetFontHeight("ui.Tahoma-8")*1.35)i:InvalidateParent(true)local j=i:Add("DLabel")j:Dock(LEFT)j:DockMargin(5,0,0,0)j:InvalidateParent(true)j:SetFont("ui.Tahoma-8")j:SetText("UniqueName - "..g)j:SetTextColor(Color(20,20,20))j:SizeToContents()local k=i:Add("DButton")k:Dock(RIGHT)k:InvalidateParent(true)k:SetContentAlignment(5)k:SetFont("ui.Tahoma-7")k:SetText("Опции")k:SizeToContents()k:SetWide(k:GetWide()*1.25)k.DoClick=function()local l=DermaMenu()l:AddOption("Настроить",function()if ix.captureSystem.HasAccess(d)==false then return end self:InitLoading("Чтение данных ...")net.Start("captureSystemEditZone")net.WriteString(g)net.SendToServer()end):SetImage("icon16/cog.png")l:AddOption("Сбросить захват",function()Derma_StringRequest("Подтверждение","Введите 'ДА'","",function(m)if m=="ДА"then if ix.captureSystem.HasAccess(d)==false then return end self:InitLoading("Сброс захвата ...")net.Start("captureSystemReset")net.WriteString(g)net.SendToServer()end end)end):SetImage("icon16/bin.png")l:AddOption("Сбросить владение",function()Derma_StringRequest("Подтверждение","Введите 'ДА', зона станет нейтральной!","",function(m)if m=="ДА"then if ix.captureSystem.HasAccess(d)==false then return end self:InitLoading("Сброс захвата ...")net.Start("captureSystemResetOwner")net.WriteString(g)net.SendToServer()end end)end):SetImage("icon16/bin.png")l:AddOption("Удалить зону",function()Derma_StringRequest("Подтверждение","Введите 'ДА'","",function(m)if m=="ДА"then if ix.captureSystem.HasAccess(d)==false then return end self:InitLoading("Удаление зоны ...")net.Start("captureSystemRemoveZone")net.WriteString(g)net.SendToServer()end end)end):SetImage("icon16/bin.png")l:Open()end i:InvalidateParent(true)i:SizeToChildren(false,true)end end function c:InitCreateZonePanel()local d=LocalPlayer()self.panelBase:Clear()local e=self.panelBase:Add("DTextEntry")e:Dock(TOP)e:DockMargin(0,0,0,5)e:InvalidateParent(true)e:SetFont("ui.Tahoma-8")e:SetValue("")e:SetPlaceholderText("Уникальное название зоны (Англ язык без пробелов и символов в верхнем регистре)")e:SetCursorColor(color_white)e:SetUpdateOnType(true)e:SizeToContents()e:SetTall(draw.GetFontHeight(e:GetFont())*1.5)e.AllowInput=function(f,g)if not string.find("abcdefghijklmnopqrstuvwxyz",g,1,true)then return true end return false end self:InitButtonPanel(self.panelBase,TOP,"Создать",function()if ix.captureSystem.HasAccess(d,true)==false then return end local f=e:GetValue()local g=string.match(f,"^[a-z]+$")if g==nil then return d:Notify("Ошибка ввода!")end self:InitLoading("Создание зоны ...")net.Start("captureSystemCreateZone")net.WriteString(g)net.SendToServer()end,"Отмена",function()self:InitCaptureList()end)self.panelBase:InvalidateParent(true)self.panelBase:SizeToChildren(false,true)self:InvalidateParent(true)self:SizeToChildren(false,true)self:Center()end function c:InitFactionList(d,e)local f=self.frameRight if IsValid(f)then return f:Close()end local g,h=self:GetPos()local i,j=self:GetSize()self:SetPos(g-i*0.25,h)g=g-i*0.25 self.frameRight=self:Add("DFrame")self.frameRight:SetTitle("Фракции")self.frameRight:SetPos(g+i+5,h)self.frameRight:SetSize(i*0.5,j)self.frameRight:MakePopup()self.frameRight.OnClose=function(k)if IsValid(self)then self:Center()end end self.frameRight.OnRemove=function(k)if IsValid(self)then self:Center()end end f=self.frameRight f.scroll=f:Add("DScrollPanel")f.scroll:Dock(FILL)f.scroll:DockPadding(0,0,0,4)f.factions={}for k,l in next,ix.faction.teams do local m=f.scroll:Add("DPanel")m:Dock(TOP)m:DockPadding(4,4,4,4)m:DockMargin(0,0,0,4)m.PaintOver=function(o,p,q)draw.RoundedBox(0,0,0,p*.01,q,l.color)end local n=m:Add("DCheckBoxLabel")n:Dock(TOP)n:SetTextColor(color_black)n:SetText(L(l.name))n:DockMargin(0,0,0,4)n.OnChange=function(o,p)e(k,p)end if d[k]then n:SetValue(true)end f.factions[k]=n end end function c:InitItemsList(d)local e=self.frameRight if IsValid(e)then return e:Close()end local f,g=self:GetPos()local h,i=self:GetSize()self:SetPos(f-h*0.25,g)f=f-h*0.25 self.frameRight=self:Add("DFrame")self.frameRight:SetTitle("Предметы")self.frameRight:SetPos(f+h+5,g)self.frameRight:SetSize(h*0.5,i)self.frameRight:MakePopup()self.frameRight.OnClose=function(k)if IsValid(self)then self:Center()end end self.frameRight.OnRemove=function(k)if IsValid(self)then self:Center()end end e=self.frameRight local j=e:Add("DTextEntry")j:Dock(TOP)j:DockMargin(0,0,0,5)j:InvalidateParent(true)j:SetFont("ui.Tahoma-8")j:SetValue("")j:SetPlaceholderText("Поиск по названию")j:SetCursorColor(color_white)j:SizeToContents()j:SetUpdateOnType(true)j.OnValueChange=function(k,l)e:ReloadList()end e.ReloadList=function(k)k.listView:Clear()local l=j:GetValue()l=string.PatternSafe(l)local m=l==""for n,o in next,ix.item.list do if o.customItem then continue end local p=o.GetName and o:GetName()or o.Name if not m and not tostring(p):utf8lower():find(l:utf8lower())then continue end local q=k.listView:AddLine(p,o.category or L"none")q.item=o.uniqueID end end e.listView=e:Add("DListView")e.listView:Dock(FILL)e.listView:AddColumn(L"name").Header:SetTextColor(color_black)e.listView:AddColumn(L"category").Header:SetTextColor(color_black)e.listView:SetSkin("Default")e.listView.OnRowRightClick=function(k,l,m)d(m.item)end e:ReloadList()end function c:CreateLabelEntry(d,e,f)local g=d:Add("DPanel")g:Dock(e)g:DockPadding(5,5,5,5)g:DockMargin(0,0,0,5)g:InvalidateParent(true)local h=g:Add("DLabel")h:Dock(LEFT)h:DockMargin(0,0,5,0)h:InvalidateParent(true)h:SetFont("ui.Tahoma-8")h:SetText(f)h:SetTextColor(color_black)h:SizeToContents()local i=g:Add("DTextEntry")i:Dock(FILL)i:InvalidateParent(true)i:SetFont("ui.Tahoma-8")i:SizeToContents()g:InvalidateParent(true)g:SizeToChildren(false,true)g:SetTall(g:GetTall()+10)return g,h,i end function c:EditMenu(d,e)local f=LocalPlayer()self.panelBase:Clear()self:SetActiveCapture(d,e)self:SetModifySize(.55,.75,"Редактирование")self:InitButtonPanel(self.panelBase,TOP,"Сохранить изменения",function()if ix.captureSystem.HasAccess(f)==false then return end net.Start("captureSystemSave")net.WriteString(d)net.WriteTable(e)net.SendToServer()end,"Назад",function()self:InitCaptureList()end,function()PrintTable(e)end)self.propertySheet=vgui.Create("DPropertySheet",self.panelBase)self.propertySheet:Dock(FILL)self:EditPropertyZone(self.propertySheet,e)self:EditPropertyRewards(self.propertySheet,e)end function c:EditPropertyRewards(d,e)local f=LocalPlayer()local g=self:GetActiveCapture()local h=e["rewards"]local i=d:Add("DScrollPanel")i:Dock(FILL)i:GetCanvas():DockPadding(5,5,5,5)d:AddSheet("Награды",i,"icon16/star.png")local j,k,l=self:CreateLabelEntry(i,TOP,"Время для получения награды сек")l:SetPlaceholderText("Время должно быть указано в секундах")l:SetValue(h.durationRewards or"")l:SetUpdateOnType(true)l.AllowInput=b l.OnValueChange=function(u,v)h.durationRewards=tonumber(v)end h["objects"]=h["objects"]or{}local m=i:Add("DPanel")m:Dock(TOP)m:DockMargin(0,0,0,5)m:DockPadding(5,5,5,5)m:InvalidateParent(true)m:SetTall(self:GetTall()*.5)local n=m:Add("DLabel")n:Dock(TOP)n:DockMargin(0,0,0,5)n:SetFont("ui.Tahoma-8")n:SetText("Настройка объектов территории")n:InvalidateParent(true)n:SetTextColor(color_black)n:SizeToContents()local o=m:Add("DScrollPanel")o:Dock(FILL)o:GetCanvas():DockPadding(5,5,5,5)o:InvalidateParent(true)o.Paint=function(u,v,w)draw.RoundedBox(0,0,0,v,w,Color(20,20,20,150))if h["objects"]and table.IsEmpty(h["objects"])==true then draw.DrawText("ВНИМАНИЕ НЕТ НАГРАД ЗА ТЕРРИТОРИЮ!","ui.Tahoma-s9",v*.5,w*.5,Color(200,50,50),TEXT_ALIGN_CENTER)end end o.UpdateList=function(u)u:Clear()for v,w in next,h["objects"]do local x=u:Add("DPanel")x:Dock(TOP)x:DockMargin(0,0,0,5)x:DockPadding(5,5,5,5)x:SetTall(self:GetTall()*.08)local y=x:Add("SpawnIcon")y:Dock(LEFT)y:InvalidateParent(true)y:SetMouseInputEnabled(false)y:SetModel(w.model)y:SetWide(x:GetTall()-10)local z=x:Add("ixLabel")z:Dock(LEFT)z:DockMargin(5,0,5,0)z:SetFont("ui.Tahoma-8")z:SetText(w.name)z:SetTextColor(color_black)z:SizeToContents()local A=x:Add("ixLabel")A:Dock(LEFT)A:DockMargin(10,0,5,0)A:SetFont("ui.Tahoma-7")A:SetText("Количество здоровья: "..w.health)A:SetTextColor(color_black)A:SizeToContents()local B=x:Add("DButton")B:Dock(RIGHT)B:SetFont("ui.Tahoma-8")B:SetText("Опции")B:SizeToContents()B:SetTall(B:GetTall()*1.25)B:InvalidateParent(true)B.DoClick=function(C)local D=DermaMenu()D:AddOption("Переместиться",function()net.Start("captureSystemGotoObject")net.WriteString(g)net.WriteVector(w.pos)net.SendToServer()end):SetImage("icon16/arrow_in.png")D:AddOption("Изменить кол-во здоровья",function()Derma_StringRequest("Количество здоровья","Введите 'Количество здоровья'","1000",function(E)if tonumber(E)then net.Start("captureSystemHealthObject")net.WriteString(g)net.WriteVector(w.pos)net.WriteUInt(E,32)net.SendToServer()A:SetText("Количество здоровья: "..E)A:SizeToContents()else f:Notify("Необходимо ввести число!")end end)end):SetImage("icon16/heart.png")D:AddOption("Удалить объект",function()Derma_StringRequest("Подтверждение","Введите 'ДА'","",function(E)if E=="ДА"then if ix.captureSystem.HasAccess(f)==false then return end net.Start("captureSystemRemoveRewardObject")net.WriteString(g)net.WriteVector(w.pos)net.SendToServer()table.RemoveByValue(h["objects"],w)o:UpdateList()end end)end):SetImage("icon16/bin.png")D:Open()end end end o:UpdateList()local p=m:Add("DButton")p:Dock(BOTTOM)p:DockMargin(0,5,0,0)p:SetFont("ui.Tahoma-8")p:SetText("Выбрать объекты территории")p:SizeToContents()p:SetTall(p:GetTall()*1.25)p:InvalidateParent(true)p.DoClick=function(u)self:InitLoading("Вход в режим редактирования ...")net.Start("captureSystemEditMode")net.WriteString(g)net.WriteString("rewardObjects")net.WriteTable(h["objects"])net.SendToServer()end m:InvalidateParent(true)m:SizeToChildren(false,true)local q=i:Add("DPanel")q:Dock(TOP)q:DockMargin(0,0,0,5)q:DockPadding(5,5,5,5)q:SetTall(self:GetTall()*.5)local r=q:Add("DLabel")r:Dock(TOP)r:DockMargin(0,0,0,5)r:SetFont("ui.Tahoma-8")r:SetText("Ежевременные награды")r:SetTextColor(color_black)r:SizeToContents()local s=q:Add("DScrollPanel")s:Dock(FILL)s:GetCanvas():DockPadding(5,5,5,5)s:InvalidateParent(true)s.Paint=function(u,v,w)draw.RoundedBox(0,0,0,v,w,Color(20,20,20,150))if h.items and table.IsEmpty(h.items)==true then draw.DrawText("ВНИМАНИЕ НЕТ НАГРАД ЗА ТЕРРИТОРИЮ!","ui.Tahoma-s9",v*.5,w*.5,Color(200,50,50),TEXT_ALIGN_CENTER)end end s.UpdateList=function(u)u:Clear()for v,w in next,h.items do if v=="money"then local x=u:Add("DLabel")x:Dock(TOP)x:DockMargin(0,0,0,5)x:SetFont("ui.Tahoma-8")x:SetText("Деньги - "..string.Comma(ix.currency.Get(w)))x:SetTextInset(5,0)x:SizeToContents()x:SetTall(x:GetTall()*1.15)x.Paint=function(y,z,A)draw.RoundedBox(0,0,0,z,A,Color(20,20,20,150))end else local x=ix.item.list[v]if x==nil then continue end local y,z=x.width,x.height local A,B=32*y,32*z local C=x.GetName and x:GetName()or x.Name local D=u:Add("EditablePanel")D:Dock(TOP)D:SetTall(B+10)D:DockMargin(0,0,0,5)D:InvalidateParent(true)D.Paint=function(I,J,K)draw.RoundedBox(0,0,0,J,K,Color(0,0,0,150))end local E=D:Add("EditablePanel")E:Dock(LEFT)E:DockMargin(5,5,5,5)E:SetWide(A)E.Paint=function(I,J,K)draw.RoundedBox(0,0,0,J,K,Color(255,255,255,100))ix.stalkerInventory.DrawItemIcon(x,J,K,I)end local F=D:Add("ixLabel")F:Dock(LEFT)F:DockMargin(5,5,5,5)F:SetFont("ui.Tahoma-8")F:SetText(C)F:SizeToContents()local G=D:Add("ixLabel")G:Dock(LEFT)G:DockMargin(5,5,5,5)G:SetFont("ui.Tahoma-8")G:SetText("MAX "..w)G:SizeToContents()local H=D:Add("ixMenuButton")H:Dock(RIGHT)H:DockMargin(5,5,5,5)H:InvalidateParent(true)H:SetContentAlignment(5)H:SetBackgroundColor(Color(100,50,50))H:SetFont("ui.Tahoma-7")H:SetText("X")H:SizeToContents()H.DoClick=function()Derma_StringRequest("Подтверждение","Введите 'ДА' для подтверждения","",function(I)if I=="ДА"then h["items"][v]=nil D:Remove()end end)end end end end s:UpdateList()local t=q:Add("DButton")t:Dock(BOTTOM)t:DockMargin(0,5,0,0)t:InvalidateParent(true)t:SetFont("ui.Tahoma-8")t:SetText("Добавить награду")t:SizeToContents()t:SetTall(t:GetTall()*1.25)t.DoClick=function(u)local v=DermaMenu()v:AddOption("Деньги",function()Derma_StringRequest("Сумма","Введите сумму награды (если сумма уже была добавлена, она заменится на введенную)","1000",function(w)w=tonumber(w)if w~=nil then h.items["money"]=w s:UpdateList()end end)end):SetImage("icon16/money.png")v:AddOption("Предметы",function()self:InitItemsList(function(w,x)h.items=h.items or{}local y=h.items for A,B in next,y do if A==w then return f:Notify("Предмет уже есть в списке!")end end local z=DermaMenu()z:AddOption("Добавить предмет",function()Derma_StringRequest("Количество","Введите количество выдаваемых предметов\n(выдача будет происходить с учетом рандома от 1 до введенного числа)","1",function(A)A=tonumber(A)if A~=nil then h.items[w]=A s:UpdateList()end end)end):SetImage("icon16/add.png")z:Open()end)end):SetImage("icon16/bin.png")v:Open()end end function c:EditPropertyZone(d,e)local f=LocalPlayer()local g=self:GetActiveCapture()local h=e.core local i=d:Add("DScrollPanel")i:Dock(FILL)i:GetCanvas():DockPadding(5,5,5,5)d:AddSheet("Территория",i,"icon16/map.png")local j=i:Add("DButton")j:Dock(TOP)j:DockMargin(0,0,0,5)j:InvalidateParent(true)j:SetFont("ui.Tahoma-8")j:SetText("Изменить зону захвата")j:SizeToContents()j:SetTall(j:GetTall()*1.25)j.DoClick=function(G)if ix.captureSystem.HasAccess(f)==false then return end self:InitLoading("Вход в режим редактирования зоны ...")net.Start("captureSystemEditMode")net.WriteString(g)net.WriteString("area")net.WriteTable(h.area)net.SendToServer()end local k,l,m=self:CreateLabelEntry(i,TOP,"Название зоны")m:SetValue(h.name or"")m:SetUpdateOnType(true)m.OnValueChange=function(G,H)h.name=H end local n,o,p=self:CreateLabelEntry(i,TOP,"Время для захвата")p:SetPlaceholderText("Время должно быть указано в секундах")p:SetValue(h.durationCapture)p.AllowInput=b p:SetUpdateOnType(true)p.OnValueChange=function(G,H)h.durationCapture=tonumber(H)end local q,r,s=self:CreateLabelEntry(i,TOP,"Время анти захвата")s:SetPlaceholderText("Время должно быть указано в секундах")s:SetValue(h.durationAntiCapture)s.AllowInput=b s:SetUpdateOnType(true)s.OnValueChange=function(G,H)h.durationAntiCapture=tonumber(H)end local t,u,v=self:CreateLabelEntry(i,TOP,"Кол-во участников для начала захвата")v:SetPlaceholderText("Количество участников группировки для захвата")v:SetValue(h.countUsers or 5)v.AllowInput=b v:SetUpdateOnType(true)v.OnValueChange=function(G,H)h.countUsers=tonumber(H)end local w=i:Add("DPanel")w:Dock(TOP)w:DockMargin(0,0,0,5)w:DockPadding(5,5,5,5)w:SetTall(self:GetTall()*.3)local x=w:Add("DLabel")x:Dock(TOP)x:DockMargin(0,0,0,5)x:SetFont("ui.Tahoma-8")x:SetText("Фракции которым разрешен захват")x:SetTextColor(color_black)x:SizeToContents()local y=w:Add("DScrollPanel")y:Dock(FILL)y:GetCanvas():DockPadding(5,5,5,5)y:InvalidateParent(true)y.Paint=function(G,H,I)draw.RoundedBox(0,0,0,H,I,Color(20,20,20,150))if h.factionsAllowed and table.IsEmpty(h.factionsAllowed)==true then draw.DrawText("ВНИМАНИЕ НЕТ РАЗРЕШЕННЫХ ГРУППИРОВОК!","ui.Tahoma-s9",H*.5,I*.5,Color(200,50,50),TEXT_ALIGN_CENTER)end end y.UpdateList=function(G)G:Clear()for H,I in next,h.factionsAllowed do local J=ix.faction.teams[H]if J==nil then f:Notify("Ошибка чтения группировки! Возможно она была удалена! \n"..H)end local K=G:Add("DLabel")K:Dock(TOP)K:DockMargin(0,0,0,5)K:SetFont("ui.Tahoma-8")K:SetText(J and J.name or"ERROR_NAME")K:SetTextInset(5,0)K:SizeToContents()K:SetTall(K:GetTall()+10)K:SetMouseInputEnabled(true)K.Paint=function(N,O,P)draw.RoundedBox(0,0,0,O,P,Color(20,20,20,150))end local M=K:Add("DButton")M:Dock(RIGHT)M:DockMargin(5,5,5,5)M:InvalidateParent(true)M:SetContentAlignment(5)M:SetFont("ui.Tahoma-7")M:SetText("X")M:SizeToContents()M.DoClick=function()Derma_StringRequest("Подтверждение","Введите 'ДА' для подтверждения","",function(N)if N=="ДА"then h.factionsAllowed[H]=nil K:Remove()if IsValid(self.frameRight)then self.frameRight:Close()end end end)end end end y:UpdateList()local z=w:Add("DButton")z:Dock(BOTTOM)z:DockMargin(0,5,0,0)z:InvalidateParent(true)z:SetFont("ui.Tahoma-8")z:SetText("Изменить разрешения для фракций")z:SizeToContents()z:SetTall(z:GetTall()*1.25)z.DoClick=function(G)self:InitFactionList(h.factionsAllowed,function(H,I)if I==false then I=nil end h.factionsAllowed[H]=I y:UpdateList()end)end h["object"]=h["object"]or{}local A=i:Add("DPanel")A:Dock(TOP)A:DockMargin(0,0,0,5)A:DockPadding(5,5,5,5)A:InvalidateParent(true)local B=A:Add("DLabel")B:Dock(TOP)B:DockMargin(0,0,0,5)B:SetFont("ui.Tahoma-8")B:SetText("Настройка объекта для захвата (Склада)")B:InvalidateParent(true)B:SetTextColor(color_black)B:SizeToContents()local C,D,E=self:CreateLabelEntry(A,TOP,"Название объекта")E:SetPlaceholderText("Может быть указано любое имя ( отображается при наведении )")E:SetValue(h["object"].name or"")E:SetUpdateOnType(true)E.OnValueChange=function(G,H)h["object"].name=H end if h["object"].model then local G=A:Add("DPanel")G:Dock(TOP)G:DockPadding(5,5,5,5)G:DockMargin(0,0,0,5)G:SetTall(self:GetTall()*.1)G:InvalidateParent(true)local H=G:Add("SpawnIcon")H:Dock(LEFT)H:InvalidateParent(true)H:SetMouseInputEnabled(false)H:SetModel(h["object"].model)H:SetWide(G:GetTall())local I=G:Add("DLabel")I:Dock(FILL)I:DockMargin(5,0,5,0)I:InvalidateParent(true)I:SetFont("ui.Tahoma-8")I:SetText(h["object"].model)I:SetTextColor(color_black)I:SizeToContents()local J=G:Add("DButton")J:Dock(RIGHT)J:DockMargin(5,5,5,5)J:InvalidateParent(true)J:SetContentAlignment(5)J:SetFont("ui.Tahoma-7")J:SetText("Переместиться к объекту")J:SizeToContents()J:SetWide(J:GetWide()*1.1)J.DoClick=function()net.Start("captureSystemGotoObject")net.WriteString(g)net.WriteVector(h["object"].pos)net.SendToServer()end G:InvalidateParent(true)G:SizeToChildren(false,true)G:SetTall(G:GetTall()+10)end local F=A:Add("DButton")F:Dock(TOP)F:DockMargin(0,0,0,0)F:SetFont("ui.Tahoma-8")F:SetText("Выбрать объект для захвата")F:SizeToContents()F:SetTall(z:GetTall()*1.25)F:InvalidateParent(true)F.DoClick=function(G)self:InitLoading("Вход в режим редактирования зоны ...")net.Start("captureSystemEditMode")net.WriteString(g)net.WriteString("object")net.WriteTable(h.object)net.SendToServer()end A:InvalidateParent(true)A:SizeToChildren(false,true)end vgui.Register("captureSystem_AdminMenu",c,"DFrame")if IsValid(ix.gui.captureSystemAdminMenu)then local d=table.Copy(ix.gui.captureSystemAdminMenu._tableCaptureList)ix.gui.captureSystemAdminMenu:Remove()timer.Simple(.1,function()ix.gui.captureSystemAdminMenu=vgui.Create("captureSystem_AdminMenu")ix.gui.captureSystemAdminMenu._tableCaptureList=d ix.gui.captureSystemAdminMenu:InitCaptureList()end)end