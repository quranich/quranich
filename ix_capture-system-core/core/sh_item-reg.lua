-- <|> Hello, fucker | Taxin2012 and PURP was here | Mysterious Zone Project | mzrp.ru <|>
local Model=Model local IsValid=IsValid local a=timer.Simple local b=net.Start local c=SERVER and net.Send local d=timer.Remove local e=math.min local f=table.Merge local print=print local g=ix.plugin.list["capture-system-core"]local h=ix.util.GetMaterial("purp/stalker/ui/ui_icon_equipment.png","smooth")local i=ix.util.GetMaterial("purp/stalker/ui/ui_icon_equipment_anomaly.png","smooth")local j=ix.util.GetMaterial("purp/stalker/ui/ui_icon_equipment_soc.png","smooth")local k=ix.util.GetMaterial("purp/stalker/ui/ui_icon_equipment-misc_01.png","smooth")local l=ix.util.GetMaterial("purp/stalker/ui/ui_icon_equipment-misc_02.png","smooth")local m={["itemCaptureRepair_02"]={name="Ремонтный набор",desc="Данный тип инструментов хорошо подойдет для ремонта незначительных повреждений",model="models/wick/wrbstalker/anomaly/items/dez_toolkit_p.mdl",weight=10,repairAmount=5,itemIcon={material=l,x=150,y=2800,width=100,height=50,},},["itemCaptureRepair_03"]={name="Профессиональный ремонтный набор",desc="Набор, способный отремонтировать объекты, которым нанесен значительный ущерб",model="models/wick/wrbstalker/anomaly/items/dez_upgr_w_1.mdl",weight=15,repairAmount=10,itemIcon={material=l,x=250,y=2800,width=100,height=50,},},["itemCaptureRepair_99"]={name="Гипер пупер супер ремонтный набор",desc="Набор, способный отремонтировать объекты, которым нанесен значительный ущерб",model="models/wick/wrbstalker/anomaly/items/dez_upgr_w_1.mdl",weight=15,repairAmount=100,itemIcon={material=l,x=250,y=2800,width=100,height=50,},},}for n,o in next,m do n=n:lower()local p=ix.item.Register(n,nil,nil,nil,true)p.name=o.name p.description=o.desc p.model=Model(o.model)p.weight=o.weight or 10 p.repairAmount=o.repairAmount or 1 p.itemIcon=o.itemIcon if o.itemIcon then p.width=o.itemIcon.width/50 or 1 p.height=o.itemIcon.height/50 or 1 end p.functions.CaptureRepairObject={name="Починить объект",icon="icon16/wrench.png",OnRun=function(q)local r=q.player local s=r:GetCharacter()local t=r:GetEyeTrace()local u=t.Entity if IsValid(u)and u:GetClass()=="capture_object"then q.noDrop=true a(.1,function()r:SetAction("Ремонт объекта",7)ix.command.Run(r,"actrepairanim")local v=r.ixSeqCallback r.ixSeqCallback=function(w)if v then v(w)end b("ixActionBarReset")c(w)d("ixStare"..w:UniqueID())end r:SetNetVar("actEnterAngle",r:EyeAngles())end)r:DoStaredAction(u,function()ix.command.Run(r,"ExitAct")local v=u:GetCaptureUniqueName()local w=ix.captureSystem.GetData(v)local x=w["core"]local y=w["rewards"]local z=e(100,u:GetRepairProgress()+q.repairAmount)local A=s:GetFaction()if ix.faction.indices[A]and ix.faction.indices[A].uniqueID=="citizen"then z=e(100,z*2)end u:SetRepairProgress(z)for C,D in next,y["objects"]do if D.pos==u:GetPos()then D.repair=z break end end ix.captureSystem.SetData(v,w)local B=ix.captureSystem.GetStorage(v)if not IsValid(B)then B=ix.captureSystem.SpawnStorage(v)else B:StartUpdateRewards(w)end q:Remove()end,7,function()q.noDrop=nil b("ixActionBarReset")c(r)r:Notify("Действие прервано необходимо смотреть на объект!")ix.command.Run(r,"ExitAct")a(.75,function()if IsValid(r)and r:GetNetVar("actEnterAngle")~=nil then ix.command.Run(r,"ExitAct")end end)end,115)else r:Notify("Необходимо смотреть на объект территории")end return false end,OnCanRun=function(q)local r=q.player local s=r:GetCharacter()return not IsValid(q.entity)and IsValid(r)and r:GetNetVar("firstPersonCamera")~=true end}ix.item.list[n]=p end for n,o in next,ix.item.instances do if m[o.uniqueID]then for p,q in next,ix.item.list[o.uniqueID]do o[p]=q end end end print("","capture system is load")