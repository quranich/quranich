-- <|> Hello, fucker | Taxin2012 and PURP was here | Mysterious Zone Project | mzrp.ru <|>
local a=ix.plugin.list["capture-system-core"]a.name="Capture System"a.author="PURP"a.description=""ix.captureSystem=ix.captureSystem or{}ix.capturePermission="Capture System"ix.captureSystem.stored=ix.captureSystem.stored or{}CAMI.RegisterPrivilege({Name=ix.capturePermission,MinAccess="superadmin",})function ix.captureSystem.HasAccess(b,c)if not CAMI.PlayerHasAccess(b,"Helix - "..ix.capturePermission)then b:Notify("У вас недостаточно прав.")return false end if c then if(b._nextCaptureSystemAction or 0)>CurTime()then b:Notify("Нужно подождать слишком частые запросы.")return false end b._nextCaptureSystemAction=CurTime()+1 end return true end function ix.captureSystem.GetLocalTriggerPosition(b,c)local d=LerpVector(0.5,b,c)local e=WorldToLocal(b,angle_zero,d,angle_zero)local f=WorldToLocal(c,angle_zero,d,angle_zero)return d,e,f end function ix.captureSystem.NotifyFaction(b,c)local d=nil local e=player.GetAll()for f=1,#e do local g=e[f]if not IsValid(g)then continue end if g:Alive()==false then continue end local h=g:GetCharacter()if not h then continue end local i=ix.faction.indices[h:GetFaction()]if i and i.uniqueID==b then g:Notify(c)d=i end end return d end function ix.captureSystem.GetTableUsers(b)local c,d={},player.GetAll()if b==nil then return d end for e=1,#d do local f=d[e]if not IsValid(f)then continue end local g=f:GetCharacter()if not g then continue end local h=ix.faction.indices[g:GetFaction()]if h and h.uniqueID==b then c[#c+1]=f end end return c end function ix.captureSystem.GetTableUsersInZone(b,c,d)d=d or ix.captureSystem.GetData(b)local e=d["core"]local f,g={},player.GetAll()if c==nil then return f end for h=1,#g do local i=g[h]if not IsValid(i)or(i:GetPos()+i:OBBCenter()):WithinAABox(e["area"].startPos,e["area"].endPos)==false then continue end if i:Alive()==false then continue end local j=i:GetCharacter()if not j then continue end local k=ix.faction.indices[j:GetFaction()]if k and k.uniqueID==c then f[#f+1]=i end end return f end function ix.captureSystem.GetTableObjectsInZone(b)local c={}for d,e in next,ents.FindByClass("capture_object")do if e:GetCaptureUniqueName()==b then c[#c+1]=e end end return c end ix.command.Add("CaptureSystemAdminMenu",{description="Система захвата - Админ меню",privilege=ix.capturePermission,superAdminOnly=true,OnRun=function(self,b)net.Start("captureSystemOpenAdminMenu")net.WriteTable(ix.captureSystem.GetListZones())net.Send(b)end})ix.util.Include("sv_plugin.lua")ix.util.Include("cl_plugin.lua")ix.util.Include("sh_item-reg.lua")ix.util.Include("networking/sv_networking.lua")ix.util.Include("networking/cl_networking.lua")ix.util.Include("editmod/cl_editmod.lua")