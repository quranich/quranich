-- <|> Hello, fucker | Taxin2012 and PURP was here | Mysterious Zone Project | mzrp.ru <|>
local a=ix.plugin.list["custom_observer"]a.name="Observer"a.author="Chessnut"a.description="Adds on to the no-clip mode to prevent intrusion."ix.option.Add("observerTeleportBack",ix.type.bool,false,{bNetworked=true,category="observer",hidden=function()return!CAMI.PlayerHasAccess(LocalPlayer(),"NoClip",nil)end})if(CLIENT)then ix.lang.AddTable("russian",{optObserverOutline="Админ Обводка (-FPS)",optdObserverOutline="Показывает обводку каждого игрока (Может снизить FPS)",optObserverUID="Показывать UID",optdObserverUID="Показывает UID вместо SteamID64",optObserverShowID="Скрыть ID",optdObserverShowID="Скрывает SteamID64 и UID"})ix.option.Add("observerESP",ix.type.bool,true,{category="observer",hidden=function()return!CAMI.PlayerHasAccess(LocalPlayer(),"NoClip",nil)end})ix.option.Add("observerOutline",ix.type.bool,true,{category="observer",hidden=function()return!CAMI.PlayerHasAccess(LocalPlayer(),"NoClip",nil)end})ix.option.Add("observerUID",ix.type.bool,false,{category="observer",hidden=function()return!CAMI.PlayerHasAccess(LocalPlayer(),"NoClip",nil)end})ix.option.Add("observerShowID",ix.type.bool,true,{category="observer",hidden=function()return!CAMI.PlayerHasAccess(LocalPlayer(),"NoClip",nil)end})local b=1024 local c=128 local d=2 function a:SetupOutlines(e)local f=LocalPlayer()if ix.option.Get("observerOutline",true)and f:GetMoveType()==MOVETYPE_NOCLIP and f:InVehicle()==false and CAMI.PlayerHasAccess(f,"NoClip",nil)then for g,h in next,player.GetHumans()do if h~=f and h:SteamID()~="NULL"and h:GetCharacter()~=nil and f:GetAimVector():Dot((h:GetPos()-f:GetPos()):GetNormal())>=0.65 then e(h,team.GetColor(h:Team()),OUTLINE_MODE_BOTH)end end end end hook.Add("HUDPaint",a.uniqueID.."HUDPaint",function()local e=LocalPlayer()if ix.option.Get("observerESP",true)and e:GetMoveType()==MOVETYPE_NOCLIP and e:InVehicle()==false and CAMI.PlayerHasAccess(e,"NoClip",nil)then local f,g=ScrW(),ScrH()for h,i in ipairs(player.GetHumans())do if(i==e or i:SteamID()=="NULL"or i:GetCharacter()==nil or e:GetAimVector():Dot((i:GetPos()-e:GetPos()):GetNormal())<0.65)then continue end local j=i:GetPos():ToScreen()local k=(i:GetPos()+i:GetAimVector()*c):ToScreen()local l,m=g*.1,g*.1 local n,o=math.Clamp(j.x,l,f-l),math.Clamp(j.y,m,g-m)local p,q=math.Clamp(k.x,l,f-l),math.Clamp(k.y,m,g-m)local r=team.GetColor(i:Team())local s=e:GetPos():Distance(i:GetPos())local t=1-math.Clamp(s/b,0,1)local u=math.max(10,32*t)local v=math.max(255*t,80)local w=(1-t*1.5)*80 surface.SetDrawColor(r.r,r.g,r.b,v)surface.SetFont("ixGenericFont")local x=i:Name()local y,z=surface.GetTextSize(x)local A=math.Clamp((i:Health()/i:GetMaxHealth())*y,0,y)surface.DrawRect(n-u/2,o-u/2,u,u)if(!ix.option.Get("cheapBlur",false))then local B={}B.start=e:EyePos()B.endpos=i:EyePos()B.filter={e,i}if(util.TraceLine(B).Hit)then w=v else w=(1-t*4)*80 end end if(k.visible)then surface.SetDrawColor(r.r*1.2,r.g*1.2,r.b*1.2,w)surface.DrawLine(n,o,p,q)surface.DrawLine(n,o+1,p,q+1)end if i:GetMoveType()==MOVETYPE_NOCLIP then ix.util.DrawText("NoClip",n,o-u*5,ColorAlpha(Color(r.r*1.6,r.g*1.6,r.b*1.6),v),TEXT_ALIGN_CENTER,TEXT_ALIGN_CENTER,nil,v)end ix.util.DrawText(x,n,o-u*4,ColorAlpha(r,v),TEXT_ALIGN_CENTER,TEXT_ALIGN_CENTER,nil,v)ix.util.DrawText(team.GetName(i:Team()),n,o-u*3,ColorAlpha(r,v),TEXT_ALIGN_CENTER,TEXT_ALIGN_CENTER,nil,v)ix.util.DrawText(i:Health().."/"..i:GetMaxHealth(),n,o-u*2,ColorAlpha(r,v),TEXT_ALIGN_CENTER,TEXT_ALIGN_CENTER,nil,v)if ix.option.Get("observerShowID")then if ix.option.Get("observerUID")then ix.util.DrawText(i:GetCharacter():GetID(),n,o-u,ColorAlpha(r,v),TEXT_ALIGN_CENTER,TEXT_ALIGN_CENTER,nil,v)else ix.util.DrawText(i:SteamID64(),n,o-u,ColorAlpha(r,v),TEXT_ALIGN_CENTER,TEXT_ALIGN_CENTER,nil,v)end end end end end)hook.Add("ShouldPopulateEntityInfo",a.uniqueID.."ShouldPopulateEntityInfo",function(e)if(IsValid(e))then if((e:IsPlayer()or IsValid(e:GetNetVar("player")))and e:GetMoveType()==MOVETYPE_NOCLIP)then return false end end end)hook.Add("DrawPhysgunBeam",a.uniqueID.."DrawPhysgunBeam",function(e,f,g,h,i,j)if(e!=LocalPlayer()and e:GetMoveType()==MOVETYPE_NOCLIP)then return false end end)hook.Add("PrePlayerDraw",a.uniqueID.."PrePlayerDraw",function(e)if(e:GetMoveType()==MOVETYPE_NOCLIP and!e:InVehicle())then return true end end)else ix.log.AddType("observerEnter",function(b,...)return string.format("%s entered observer.",b:Name())end)ix.log.AddType("observerExit",function(b,...)if(ix.option.Get(b,"observerTeleportBack",true))then return string.format("%s exited observer.",b:Name())else return string.format("%s exited observer at their location.",b:Name())end end)hook.Add("CanPlayerEnterVehicle",a.uniqueID.."CanPlayerEnterVehicle",function(b,c,d)if(b:GetMoveType()==MOVETYPE_NOCLIP)then return false end end)hook.Add("Kouka.PlayerNoClip","ixObserver_NoClip",function(b,c)if c then b.ixObsData={b:GetPos(),b:EyeAngles()}b:SetNoDraw(true)b:SetNotSolid(true)b:DrawWorldModel(false)b:DrawShadow(false)b:GodEnable()b:SetNoTarget(true)hook.Run("OnPlayerObserve",b,c)else if(b.ixObsData)then if(ix.option.Get(b,"observerTeleportBack",true))then local d,e=b.ixObsData[1],b.ixObsData[2]timer.Simple(0,function()b:SetPos(d)b:SetEyeAngles(e)b:SetVelocity(Vector(0,0,0))end)end b.ixObsData=nil end b:SetNoDraw(false)b:SetNotSolid(false)b:DrawWorldModel(true)b:DrawShadow(true)b:GodDisable()b:SetNoTarget(false)hook.Run("OnPlayerObserve",b,c)end end)hook.Add("OnPlayerObserve",a.uniqueID.."OnPlayerObserve",function(b,c)if(c)then ix.log.Add(b,"observerEnter")else ix.log.Add(b,"observerExit")end end)end