-- <|> Hello, fucker | Taxin2012 and PURP was here | Mysterious Zone Project | mzrp.ru <|>
local a=KoukaPlugin a.name="Commands"a.noUnload=true a.hashMap=a.hashMap or{registeredPrefixes={}}kouka.indexHashMap.Command=function(b,c)b.commands=b.commands or{}c.name=c[1]c[1]=nil c.func=c[2]c[2]=nil if CLIENT then c.isClientCMD=true end if c.prefix~=nil then if a.hashMap.registeredPrefixes[c.prefix]~=nil then return a:Print(string.format('Command "%s": prefix "%s" already used!',c.name,c.prefix),true)end a.hashMap.registeredPrefixes[c.prefix]=c end b.commands[c.name]=c end kouka.commands=kouka.commands or{Parse=function(b,c)local d={}local e=false local f=true local g=0 for h=1,b:len()do local i=b[h]if c and g==c and e==false then d[g]=d[g]..i elseif i=="\""then f=true e=not e elseif i==" "and e==false then f=true elseif f then f=false g=g+1 d[g]=i else d[g]=d[g]..i end end return d,f end,GetAll=function()if kouka.commands.list then return kouka.commands.list end kouka.commands.list={}for b,c in next,kouka.plugins do if c.commands then for d,e in next,c.commands do kouka.commands.list[d]=e end end end if kouka.commands.listReceived then table.Merge(kouka.commands.list,kouka.commands.listReceived)end kouka.commands.listReceived=nil return kouka.commands.list end,Get=function(b)return kouka.commands.GetAll()[b]end,Build=function(b,c)local d={}for e,f in next,b do if c or e<#b then local g=f:find(" ",nil,true)and"\""or""d[#d+1]=g..f..g end end return table.concat(d," ")end}function a.hashMap.FindChatCommand(b,c)if b==nil then return end b=b:uForce()local d local e=0 for j,k in next,a.hashMap.registeredPrefixes do local l=#j if b:uLeft(l)==j and l>e and(k.isClientCMD or((SERVER and kouka.HasFlag(c,"CMD "..k.name))or kouka.HasFlag("CMD "..k.name)))then d=k e=l break end end if d then return d,b:uSub(e+1)end local f,g,h=b:match("^(%p)(%S+)%s*(.*)$")local i=f=="$"if f=="!"or(i and((SERVER and kouka.HasFlag(c,"Silent"))or kouka.HasFlag("Silent")))then local j=kouka.commands.GetAll()[g:uLower()]if j~=nil then local k=j.isClientCMD if i and k then return end if k or((SERVER and kouka.HasFlag(c,"CMD "..j.name))or kouka.HasFlag("CMD "..j.name))then return j,h,i end end end end a:Hook("Kouka.PluginUnloaded",function(b)kouka.commands.list=nil end)a:Hook("Kouka.PluginLoaded",function(b)kouka.commands.list=nil end)kouka.Include("cl_commands.lua")