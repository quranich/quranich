-- <|> Hello, fucker | Taxin2012 and PURP was here | Mysterious Zone Project | mzrp.ru <|>
local AccessorFunc=AccessorFunc local a=vgui.Create local DDragBase=DDragBase local pairs=pairs local b=table.RemoveByValue local c=table.insert local d=derma.SkinHook local VGUIFrameTime=VGUIFrameTime local e=dragndrop.IsDragging local IsValid=IsValid local f=math.Clamp local g=vgui.Register local h={}AccessorFunc(h,"m_iOverlap","Overlap")AccessorFunc(h,"m_bShowDropTargets","ShowDropTargets",FORCE_BOOL)function h:Init()self.Panels={}self.OffsetX=0 self.FrameTime=0 self.pnlCanvas=a("DDragBase",self)self.pnlCanvas:SetDropPos("6")self.pnlCanvas:SetUseLiveDrag(false)self.pnlCanvas.OnModified=function()self:OnDragModified()end self.pnlCanvas.UpdateDropTarget=function(i,j,k)if(!self:GetShowDropTargets())then return end DDragBase.UpdateDropTarget(i,j,k)end self.pnlCanvas.OnChildAdded=function(i,j)local k=i:GetDnD()if(k)then j:Droppable(k)j.OnDrop=function()local l,m=i:LocalCursorPos()local n,o=self.pnlCanvas:GetClosestChild(l,i:GetTall()/2),0 for p,q in pairs(self.Panels)do if(q==n)then o=p break end end b(self.Panels,j)c(self.Panels,o,j)self:InvalidateLayout()return j end end end self:SetOverlap(0)self.btnLeft=a("DButton",self)self.btnLeft:SetText("")self.btnLeft.Paint=function(i,j,k)d("Paint","ButtonLeft",i,j,k)end self.btnRight=a("DButton",self)self.btnRight:SetText("")self.btnRight.Paint=function(i,j,k)d("Paint","ButtonRight",i,j,k)end end function h:GetCanvas()return self.pnlCanvas end function h:ScrollToChild(i)self:InvalidateLayout(true)local j,k=self.pnlCanvas:GetChildPosition(i)local l,m=i:GetSize()j=j+l*0.5 j=j-self:GetWide()*0.5 self:SetScroll(j)end function h:SetScroll(i)self.OffsetX=i self:InvalidateLayout(true)end function h:SetUseLiveDrag(i)self.pnlCanvas:SetUseLiveDrag(i)end function h:MakeDroppable(i)self.pnlCanvas:MakeDroppable(i)end function h:AddPanel(i)c(self.Panels,i)i:SetParent(self.pnlCanvas)self:InvalidateLayout(true)end function h:Clear()self.pnlCanvas:Clear()self.Panels={}end function h:OnMouseWheeled(i)self.OffsetX=self.OffsetX-i*-30 self:InvalidateLayout(true)return true end function h:Think()local i=VGUIFrameTime()-self.FrameTime self.FrameTime=VGUIFrameTime()if(self.btnRight:IsDown())then self.OffsetX=self.OffsetX-(500*i)self:InvalidateLayout(true)end if(self.btnLeft:IsDown())then self.OffsetX=self.OffsetX+(500*i)self:InvalidateLayout(true)end if(e())then local j,k=self:LocalCursorPos()if(j<30)then self.OffsetX=self.OffsetX-(350*i)elseif(j>self:GetWide()-30)then self.OffsetX=self.OffsetX+(350*i)end self:InvalidateLayout(true)end end function h:PerformLayout()local i,j=self:GetSize()self.pnlCanvas:SetTall(j)local k=0 for l,m in pairs(self.Panels)do if(!IsValid(m))then continue end if(!m:IsVisible())then continue end m:SetPos(k,0)m:SetTall(j)if(m.ApplySchemeSettings)then m:ApplySchemeSettings()end k=k+m:GetWide()-self.m_iOverlap end self.pnlCanvas:SetWide(k+self.m_iOverlap)if(i<self.pnlCanvas:GetWide())then self.OffsetX=f(self.OffsetX,0,self.pnlCanvas:GetWide()-self:GetWide())else self.OffsetX=0 end self.pnlCanvas.x=(i-self.pnlCanvas:GetWide())-self.OffsetX*-1 self.btnLeft:SetSize(15,15)self.btnLeft:AlignLeft(4)self.btnLeft:AlignBottom(5)self.btnRight:SetSize(15,15)self.btnRight:AlignRight(4)self.btnRight:AlignBottom(5)self.btnLeft:SetVisible(self.pnlCanvas.x<0)self.btnRight:SetVisible(self.pnlCanvas.x+self.pnlCanvas:GetWide()>self:GetWide())end function h:OnDragModified()end g("stalker-pda.DHorizontalScroller",h,"Panel")