-- <|> Hello, fucker | Taxin2012 and PURP was here | Mysterious Zone Project | mzrp.ru <|>
local a=SERVER and util.AddNetworkString local b=net.Receive local IsValid=IsValid local c=hook.Run local d=hook.Add local LocalPlayer=LocalPlayer local e=ix.plugin.list["personal-digital-assistant"]e.name="Personal Digital Assistant (PDA)"e.author="PURP"e.description=""ix.pda=ix.pda or{}ix.pda.listApps=ix.pda.listApps or{}ALWAYS_RAISED["mz-personal-digital-assistant"]=true ix.util.Include("cl_bind_pda.lua")ix.util.Include("cl_personal-digital-assistance.lua")ix.util.Include("cl_drawfuncs.lua")function ix.pda.GetApps()return ix.pda.listApps or{}end function ix.pda.RegisterApp(g,h)g=g:lower()h._index=g ix.pda.listApps[g]=h end if SERVER then a("PDA_TriggerBind")b("PDA_TriggerBind",function(g,h)if(h._nextTriggerPDA or 0)>CurTime()then return end h._nextTriggerPDA=CurTime()+2 if h:IsRestricted()then return h:Notify(L("notNow",h))end local i=h:GetCharacter()if not i then return end local j=i:GetInventory()local k=j:HasItem("itempda")if k then local l="mz-personal-digital-assistant"local m=h:GetWeapon(l)if not IsValid(m)then m=h:Give(l)end local n=h:GetActiveWeapon()if IsValid(n)and n:GetClass()~=l then h._lastWeaponPDA=n:GetClass()h:SelectWeapon(l)else h:SelectWeapon(h._lastWeaponPDA)end end end)else c("PDALoadAPP")d("WeaponCycleSound","PDA.WeaponCycleSound",function()local g=LocalPlayer():GetActiveWeapon()if IsValid(g)and g:GetClass()=="mz-personal-digital-assistant"then return"",0 end end)end local function f()local g=ix.itemsListMaterials local h=ix.util.GetMaterial("purp/stalker/ui/ui_actor_multiplayer_game_menu.png")local i=ix.item.Register("itempda",nil,nil,nil,true)i.name="ПДА"i.description="Является неотъемлемой частью экипировки сталкера. В основном применяется для связи с другими сталкерами или как карта. Не менее редко применяется как дневник."i.model=Model("models/wick/wrbstalker/anomaly/items/wick_dev_pda.mdl")i.weight=.2 i.noDeathDrop=true i.itemIcon={material=g.ui_icon_equipment_misc_03,x=350,y=150,width=50,height=50,}i.width=1 i.height=1 function i:GetDescription()local j=self.description or""if self:GetData("isTurn",false)==false then j="ПДА ВЫКЛЮЧЕН\n\n"..j end return j end i:Hook("drop",function(j)local k=j.player if IsValid(k)then k:StripWeapon("mz-personal-digital-assistant")end end)i.OnTransferred=function(j,k,l)if k.GetOwner then local m=k:GetOwner()if m and m:IsPlayer()then m:StripWeapon("mz-personal-digital-assistant")end end end i.OnPlaceItem=function(j,k,l)local m=l:GetWeapon("mz-personal-digital-assistant")if IsValid(m)then l:StripWeapon("mz-personal-digital-assistant")end end i.functions.TurnOn={name="Включить пда",icon="icon16/application_osx_terminal.png",OnRun=function(j)local k=j.player j:SetData("isTurn",true)k:EmitSound("purp/device/pda/pda_draw.ogg",40,100,1)return false end,OnCanRun=function(j)local k=j.player local l=k:GetCharacter()local m,n,o=l:GetInventory(),l:GetEquipmentInventory()local p=m:GetID()local q,r,s=j.entity,j:GetData("isTurn",false),j.invID return not IsValid(q)and IsValid(k)and r==false and p==s end}i.functions.TurnOff={name="Выключить пда",icon="icon16/application_osx_terminal.png",OnRun=function(j)local k=j.player j:SetData("isTurn",false)k:EmitSound("purp/device/pda/pda_draw.ogg",40,100,1)return false end,OnCanRun=function(j)local k=j.player local l=k:GetCharacter()local m,n,o=l:GetInventory(),l:GetEquipmentInventory()local p=m:GetID()local q,r,s=j.entity,j:GetData("isTurn",false),j.invID return not IsValid(q)and IsValid(k)and r==true and p==s end}i.PaintOver=function(j,k,l,m)local n=k:GetData("isTurn",false)if n==false then draw.Outline(0,0,l,m,Color(255,50,50,50),1)end surface.SetMaterial(h)surface.SetDrawColor(color_white)surface.DrawPartialTexturedRect(0,m-16,16,16,955,n and 212 or 180,32,32,1024,1024)end ix.item.list["itempda"]=i end hook.Add("PostInitializedItemsList",e.uniqueID.."PostInitializedItemsList_MiscItems",f)if IX_PLUGINS_LOADED then f()end