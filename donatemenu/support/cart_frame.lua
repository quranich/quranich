-- <|> Hello, fucker | Taxin2012 and PURP was here | Mysterious Zone Project | mzrp.ru <|>
local a={}function a:UpdateCart()for b,c in next,AutoDonate.cartPanel.items do c:Remove()end for b,c in next,AutoDonate.cart do AutoDonate.AddShipmentToCart(b,c.itemID,c.price,c.isTC)end AutoDonate.cartPanel.totalLabel:SetText(AutoDonate.totalPriceCredits.." MZC"..((AutoDonate.bonusCredits>0 and" | "..AutoDonate.totalPriceBonusCredits.." TC")or""))AutoDonate.cartPanel.totalLabel:SizeToContents()end function AutoDonate.AddShipmentToCart(b,c,d,e)local f=AutoDonate.cartPanel:Add("DPanel")f:Dock(TOP)f:DockMargin(0,5,0,0)f:SetTall(AutoDonate.multiplyResolution(AutoDonate.y,0.06))f.Paint=function(k,l,m)surface.SetDrawColor(0,0,0,100)surface.DrawRect(0,0,l,m)end f.cartIndex=b f.itemID=c f.isTC=e local g=AutoDonate.cache[c]local h=f:Add("DLabel")h:Dock(LEFT)h:SetFont("font.donate.medium")h:SetText(g.name)h:SetTextInset(AutoDonate.multiplyResolution(AutoDonate.x,0.01),0)h:SetWide(AutoDonate.multiplyResolution(AutoDonate.x,0.3))local i=f:Add("DLabel")i:Dock(LEFT)i:SetFont("font.donate.medium")i:SetText((d or AutoDonate.GetDiscountPrice(g.price,g.discount))..((e and" TC")or" MZC"))i:SetTextInset(AutoDonate.multiplyResolution(AutoDonate.x,0.01),0)i:SetWide(AutoDonate.multiplyResolution(AutoDonate.x,0.24))i:SetContentAlignment(5)local j=f:Add("DButton")j:Dock(FILL)j:SetFont("font.donate.medium")j:SetText("X")j.g_ship=f j:SetTextInset(AutoDonate.multiplyResolution(AutoDonate.x,0.01),0)j:SetWide(AutoDonate.multiplyResolution(AutoDonate.x,0.1))j:SetContentAlignment(5)j.DoClick=function(k)k.g_ship:SlideUp(0.15)AutoDonate.Cart(b)AutoDonate.cartPanel:GetParent():GetParent():UpdateCart()end j.Paint=function(k)j:SetTextColor((k:IsHovered()and kouka.colors.red)or kouka.colors.white)end AutoDonate.cartPanel.items[#AutoDonate.cartPanel.items+1]=f end function a:Init()local b=self:Add("DPanel")b:Dock(FILL)b:DockMargin(0,0,0,0)b.posX,b.posY=ScrW()*0,ScrH()*-1 b.Paint=function()end b:CreateAnimation(AutoDonate.animationTime*3,{target={posY=ScrH()*0},easing="outQuint",Think=function(k,l)b:SetPos(b.posX,b.posY)end,})local c=b:Add("DLabel")c:SetFont("font.donate.black.big")c:SetText("Ваша корзина товаров")c:SizeToContents()c:Dock(TOP)c:DockMargin(50,25,0,0)AutoDonate.cartPanel=b:Add("DScrollPanel")AutoDonate.cartPanel:Dock(FILL)AutoDonate.cartPanel:DockMargin(25,25,25,25)AutoDonate.cartPanel.items={}local d=AutoDonate.cartPanel:Add("DPanel")d:Dock(TOP)d:SetTall(AutoDonate.multiplyResolution(AutoDonate.y,0.03))d.Paint=function()end local e=d:Add("DLabel")e:Dock(LEFT)e:SetFont("font.donate.medium")e:SetText("Товар")e:SetTextInset(AutoDonate.multiplyResolution(AutoDonate.x,0.01),0)e:SetTextColor(Color(2,222,243))e:SetWide(AutoDonate.multiplyResolution(AutoDonate.x,0.3))local f=d:Add("DLabel")f:Dock(LEFT)f:SetFont("font.donate.medium")f:SetText("Цена")f:SetTextInset(AutoDonate.multiplyResolution(AutoDonate.x,0.01),0)f:SetTextColor(Color(2,222,243))f:SetWide(AutoDonate.multiplyResolution(AutoDonate.x,0.24))f:SetContentAlignment(5)local g=d:Add("DLabel")g:Dock(FILL)g:SetFont("font.donate.medium")g:SetText("Удалить")g:SetTextInset(AutoDonate.multiplyResolution(AutoDonate.x,0.01),0)g:SetTextColor(Color(2,222,243))g:SetWide(AutoDonate.multiplyResolution(AutoDonate.x,0.1))g:SetContentAlignment(5)for k,l in next,AutoDonate.cart do AutoDonate.AddShipmentToCart(k,l.itemID,l.price,l.isTC)end local h=b:Add("DPanel")h:Dock(BOTTOM)h:DockMargin(15,0,15,15)h:SetTall(AutoDonate.multiplyResolution(AutoDonate.y,0.1))h.Paint=function()end local i=h:Add("DButton")i:SetFont("font.donate.medium")i:Dock(RIGHT)i:SetWide(AutoDonate.multiplyResolution(AutoDonate.x,0.0925))i:SetText("Купить")i:DockMargin(0,19,20,19)i.Paint=function(k,l,m)surface.SetMaterial(Material("mzmenu/donate/tocart_btn_noh.png"))surface.SetDrawColor(255,255,255,255)if k:IsHovered()then surface.SetDrawColor(255,255,255,200)end surface.DrawTexturedRect(0,0,l,m)end i.DoClick=function()if AutoDonate.Purchase()~=nil then self:UpdateCart()end end AutoDonate.cartPanel.totalLabel=h:Add("DLabel")AutoDonate.cartPanel.totalLabel:SetFont("font.donate.black.big")AutoDonate.cartPanel.totalLabel:Dock(RIGHT)AutoDonate.cartPanel.totalLabel:SetTextColor(Color(247,255,33))AutoDonate.cartPanel.totalLabel:SetText(0)AutoDonate.cartPanel.totalLabel:DockMargin(0,0,20,0)self:UpdateCart()local j=h:Add("DLabel")j:SetFont("font.donate.black.big")j:Dock(RIGHT)j:SetText("Итого:")j:DockMargin(0,0,15,0)j:SizeToContents()end vgui.Register("autodonate_cart",a,"Panel")